import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{B as Te}from"./Base-CrLrAwBj.js";import{S as B}from"./SwitchFormGroup-CGYpv_4Q.js";import{T as Ee}from"./TextareaFormGroup-DVzYJtLM.js";import{r}from"./index-BH53Isel.js";import{c as ze}from"./ReactAppend-DTVVXReZ.js";import{s as ee}from"./server.browser-Bf4gQIc7.js";import{S as V}from"./ProductCard-Ap6bpF1Q.js";import{I as he}from"./ItemsRest-B6zEWLhk.js";import{M as me}from"./Modal-CIqmjseY.js";import{T as Pe}from"./Table-DitbKwtZ.js";import{I as $e}from"./ImageFormGroup-BPR9pDAU.js";import{I as U}from"./InputFormGroup-D5I6zpZc.js";import{Q as _e}from"./QuillFormGroup-D8zDHSfJ.js";import{S as E}from"./SelectAPIFormGroup-VVeKHwcX.js";import{S as Be}from"./SelectFormGroup-YqB1XVb8.js";import{D as de}from"./DxButton-DV0H-ZcL.js";import{C as Me}from"./CreateReactScript-BoGwggCx.js";import{N as pe}from"./Number2Currency-e57Tgsuk.js";import{R as z}from"./ReactAppend-D7S498fx.js";import{S as M}from"./SetSelectValue-UxyCmHse.js";import"./main-BvVILmTO.js";import"./index-CMHsc23u.js";import"./index-yBjzXJbu.js";import"./Global-ErywZRdd.js";import"./tippy-react.esm-BWiGTO87.js";import"./index-rimy3MAc.js";import"./index-fNjTmf9T.js";/* empty css              */import"./Logout-7s5dsuEK.js";import"./MenuItemContainer-C_dOKkRB.js";import"./index.esm-DAJ8Pwbk.js";import"./index-xsH4HHeE.js";import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";import"./BasicRest-9qsOCV42.js";/* empty css               */import"./General-BmbBKdsB.js";import"./LaravelSession-Dz9cpV3l.js";const ue=({label:F,structure:x,value:C=[],onChange:v,typeOptions:y=[]})=>{const[g,f]=r.useState([]),N=r.useRef(!0);r.useEffect(()=>{if(N.current){const m=C.map(c=>{var h,p;return{...c,type:((h=c.type)==null?void 0:h.charAt(0).toUpperCase())+((p=c.type)==null?void 0:p.slice(1).toLowerCase())}});f(m),N.current=!1}else if(JSON.stringify(C)!==JSON.stringify(g)){const m=C.map(c=>{var h,p;return{...c,type:((h=c.type)==null?void 0:h.charAt(0).toUpperCase())+((p=c.type)==null?void 0:p.slice(1).toLowerCase())}});f(m)}},[C]);const k=()=>{const m=[...g,{...x}];f(m),v([...g,x])},w=m=>{const c=g.filter((h,p)=>p!==m);f(c),v(c)},b=(m,c,h)=>{const p=[...g];p[m][c]=c==="type"?h.charAt(0).toUpperCase()+h.slice(1).toLowerCase():h,f(p),v(p)};return e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:F}),g.map((m,c)=>{g.length%2!==0&&g.length-1;const h=x.hasOwnProperty("description")&&Object.keys(x).length===1,p=x.hasOwnProperty("title")&&x.hasOwnProperty("description")&&x.hasOwnProperty("tooltip");return e.jsx("div",{className:"mb-3 p-3 border rounded position-relative",style:{backgroundColor:"#ffffff",border:"1px solid #dee2e6"},children:e.jsxs("div",{className:"row",children:[typeof m=="object"?e.jsx("div",{className:"col-12",children:h?e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label text-muted mb-1",style:{fontSize:"0.85rem",fontWeight:"500"},children:"Descripción"}),e.jsx("textarea",{className:"form-control",value:m.description||"",onChange:n=>b(c,"description",n.target.value),placeholder:"Ingrese la descripción general",rows:4,style:{minHeight:"120px",maxHeight:"200px",resize:"vertical"}})]}):p?e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-6 mb-2",children:[e.jsx("label",{className:"form-label text-muted mb-1",style:{fontSize:"0.85rem",fontWeight:"500"},children:"Título"}),e.jsx("textarea",{className:"form-control",value:m.title||"",onChange:n=>b(c,"title",n.target.value),placeholder:"Título de la especificación",rows:2,style:{minHeight:"60px",maxHeight:"100px",resize:"vertical"}})]}),e.jsxs("div",{className:"col-md-6 mb-2",children:[e.jsx("label",{className:"form-label text-muted mb-1",style:{fontSize:"0.85rem",fontWeight:"500"},children:"Descripción"}),e.jsx("textarea",{className:"form-control",value:m.description||"",onChange:n=>b(c,"description",n.target.value),placeholder:"Descripción técnica detallada",rows:3,style:{minHeight:"80px",maxHeight:"150px",resize:"vertical"}})]}),e.jsxs("div",{className:"col-12 mb-2",children:[e.jsx("label",{className:"form-label text-muted mb-1",style:{fontSize:"0.85rem",fontWeight:"500"},children:"Tooltip (información adicional)"}),e.jsx("input",{type:"text",className:"form-control",value:m.tooltip||"",onChange:n=>b(c,"tooltip",n.target.value),placeholder:"Información adicional que aparecerá en tooltip"})]})]}):e.jsx("div",{className:"row",children:Object.keys(x).map(n=>e.jsxs("div",{className:"col-md-6 mb-2",children:[e.jsx("label",{className:"form-label text-muted mb-1",style:{fontSize:"0.85rem",fontWeight:"500"},children:n==="type"?"Tipo":n.charAt(0).toUpperCase()+n.slice(1)}),n==="type"?e.jsxs("select",{className:"form-select",value:m[n]||"",onChange:j=>b(c,n,j.target.value),children:[e.jsx("option",{value:"",children:"Seleccionar tipo"}),y.map(j=>e.jsx("option",{value:j,children:j},j))]}):e.jsx("textarea",{className:"form-control",value:m[n]||"",onChange:j=>b(c,n,j.target.value),placeholder:`Ingrese ${n.charAt(0).toUpperCase()+n.slice(1)}`,rows:4,style:{minHeight:"120px",maxHeight:"200px",resize:"vertical"}})]},n))})}):e.jsxs("div",{className:"col-12 mb-2",children:[e.jsx("label",{className:"form-label text-muted mb-1",style:{fontSize:"0.85rem",fontWeight:"500"},children:"Característica"}),e.jsx("textarea",{className:"form-control",value:m,onChange:n=>b(c,null,n.target.value),placeholder:"Describe la característica del producto",rows:4,style:{minHeight:"120px",maxHeight:"200px",resize:"vertical"}})]}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm rounded-circle position-absolute",style:{top:"8px",right:"8px",width:"28px",height:"28px",padding:"0",zIndex:10,boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},onClick:()=>w(c),title:"Eliminar campo",children:e.jsx("i",{className:"mdi mdi-close",style:{fontSize:"14px",color:"white"}})})]})},c)}),e.jsx("div",{className:"text-center mt-3",children:e.jsxs("button",{type:"button",className:"btn btn-primary px-4 py-2",onClick:k,children:[e.jsx("i",{className:"mdi mdi-plus me-2"}),"Agregar"]})})]})},Ge=new he,Oe=({gridRef:F,modalRef:x})=>{const[C,v]=r.useState(null),[y,g]=r.useState(!1),[f,N]=r.useState(""),[k,w]=r.useState(!1),b=c=>{v(c.target.files[0])},m=async()=>{var h,p;if(!C){N("Por favor, selecciona un archivo."),w(!0);return}const c=new FormData;c.append("file",C),g(!0);try{const n=await Ge.importData(c);if(console.log(n),n.error){const j=Array.isArray(n.error)?n.error.join(`
`):n.error;N(`Error en la importación:
${j}`),w(!0)}else N(n.message),w(!1),$(F.current).dxDataGrid("instance").refresh(),x.current&&$(x.current).modal("hide")}catch(n){N("Error al importar: "+(((p=(h=n.response)==null?void 0:h.data)==null?void 0:p.error)||n.message)),w(!0)}g(!1)};return e.jsx("div",{className:"bg-white",children:e.jsxs("div",{className:"modal-content",children:[e.jsx("div",{className:"mb-1",children:e.jsx("a",{href:"/assets/img/salafabulosa/formato_import_products.xlsx",download:!0,children:"Descargar formato .xlsx"})}),e.jsx("div",{children:e.jsx("input",{className:"form-control",type:"file",accept:".xlsx",onChange:b})}),e.jsx("button",{onClick:m,disabled:y,className:"btn btn-primary mt-2",type:"button",children:y?"Subiendo...":"Subir Archivo"}),f&&e.jsx("div",{className:`alert ${k?"alert-danger":"alert-success"} mt-2`,role:"alert",children:e.jsx("div",{className:"alert-message",children:f})})]})})},G=new he,Le=({categories:F,brands:x,collections:C,attributes:v})=>{const[y,g]=r.useState([]),f=r.useRef(),N=r.useRef(),k=r.useRef(),w=r.useRef(),b=r.useRef(),m=r.useRef(),c=r.useRef(),h=r.useRef(),p=r.useRef(),n=r.useRef(),j=r.useRef(),W=r.useRef(),J=r.useRef(),O=r.useRef();r.useRef();const q=r.useRef(),Q=r.useRef();r.useRef([]);const fe=r.useRef([]),[xe,se]=r.useState(!1),[He,ge]=r.useState(null),[Ve,be]=r.useState(null),[S,D]=r.useState([]),te=r.useRef(),[R,I]=r.useState([]),ie=r.useRef(),[je,Ue]=r.useState([]),[A,L]=r.useState([]),[T,P]=r.useState([]),X=r.useRef(),[We,Je]=r.useState(!1),K=r.useRef(),ve=s=>{const l=Array.from(s.target.files).map(i=>({file:i,url:URL.createObjectURL(i)}));D(i=>[...i,...l])},ye=s=>{s.preventDefault();const l=Array.from(s.dataTransfer.files).map(i=>({file:i,url:URL.createObjectURL(i)}));D(i=>[...i,...l])},ae=s=>{s.preventDefault()},Ne=(s,t)=>{s.preventDefault(),S[t].id?D(i=>i.map((o,a)=>a===t?{...o,toDelete:!0}:o)):D(i=>i.filter((o,a)=>a!==t))},we=s=>{const t=Array.from(s.target.files),l=10*1024*1024,i=[],o=[];t.forEach(a=>{a.size>l?o.push(a.name):i.push({file:a,name:a.name,size:a.size,type:a.type})}),o.length>0&&V.fire({title:"Archivos muy pesados",html:`Los siguientes archivos exceden el límite de 10MB y no se pueden subir:<br><br><strong>${o.join("<br>")}</strong><br><br>Por favor, comprime los archivos o utiliza un servicio de almacenamiento en la nube.`,icon:"warning",confirmButtonText:"Entendido"}),i.length>0&&I(a=>[...a,...i])},Se=s=>{s.preventDefault();const t=Array.from(s.dataTransfer.files),l=10*1024*1024,i=[],o=[];t.forEach(a=>{a.size>l?o.push(a.name):i.push({file:a,name:a.name,size:a.size,type:a.type})}),o.length>0&&V.fire({title:"Archivos muy pesados",html:`Los siguientes archivos exceden el límite de 10MB y no se pueden subir:<br><br><strong>${o.join("<br>")}</strong><br><br>Por favor, comprime los archivos o utiliza un servicio de almacenamiento en la nube.`,icon:"warning",confirmButtonText:"Entendido"}),i.length>0&&I(a=>[...a,...i])},Re=(s,t)=>{s.preventDefault(),R[t].id?I(i=>i.map((o,a)=>a===t?{...o,toDelete:!0}:o)):I(i=>i.filter((o,a)=>a!==t))},Ce=s=>{if(s===0)return"0 Bytes";const t=1024,l=["Bytes","KB","MB","GB"],i=Math.floor(Math.log(s)/Math.log(t));return parseFloat((s/Math.pow(t,i)).toFixed(2))+" "+l[i]},De=s=>{switch(s.split(".").pop().toLowerCase()){case"pdf":return"mdi-file-pdf";case"doc":case"docx":return"mdi-file-word";case"xls":case"xlsx":return"mdi-file-excel";case"ppt":case"pptx":return"mdi-file-powerpoint";case"zip":case"rar":return"mdi-folder-zip";case"txt":return"mdi-file-document";default:return"mdi-file"}};r.useEffect(()=>{if(y&&y.images){const s=y.images.map(t=>({id:t.id,url:`/storage/images/item/${t.url}`}));D(s)}if(y&&y.downloadables){const s=y.downloadables.map(t=>({id:t.id,name:t.original_name||t.name,url:`/storage/images/downloads/item/${t.url}`,size:t.size||0,type:t.mime_type||"application/octet-stream"}));I(s)}},[y]);const le=s=>{var t,l,i,o;if(console.log("data total",s),g(s||null),s!=null&&s.id?se(!0):se(!1),k.current.value=(s==null?void 0:s.id)||"",$(w.current).val((s==null?void 0:s.category_id)||null).trigger("change"),M(b.current,(t=s==null?void 0:s.family)==null?void 0:t.id,(l=s==null?void 0:s.family)==null?void 0:l.name),M(m.current,(i=s==null?void 0:s.platform)==null?void 0:i.id,(o=s==null?void 0:s.platform)==null?void 0:o.name),M(c.current,(s==null?void 0:s.applications)??[],"id","name"),M(h.current,(s==null?void 0:s.symbologies)??[],"id","name"),M(p.current,(s==null?void 0:s.technologies)??[],"id","name"),n.current.value=(s==null?void 0:s.name)||"",j.current.value=(s==null?void 0:s.summary)||"",W.current.value=(s==null?void 0:s.price)||0,J.current.value=(s==null?void 0:s.discount)||0,O.current.value=null,O.image.src=`/storage/images/item/${(s==null?void 0:s.image)??"undefined"}`,q.editor.root.innerHTML=(s==null?void 0:s.description)??"",s!=null&&s.images){const a=s.images.map(u=>({id:u.id,url:`/api/items/gallery/media/${u.url}`}));D(a)}else D([]);if(s!=null&&s.downloadables){const a=s.downloadables.map(u=>({id:u.id,name:u.original_name||u.name,url:`/storage/downloads/item/${u.url}`,size:u.size||0,type:u.mime_type||"application/octet-stream"}));I(a)}else I([]);s!=null&&s.specifications?L(s.specifications.map(a=>({type:a.type,title:a.title,description:a.description,tooltip:a.tooltip}))):L([]),s!=null&&s.attributes?P(s.attributes.map(a=>{var u;return{attribute_id:a.id,attribute_name:a.name,value:((u=a.pivot)==null?void 0:u.value)||""}})):P([]),X.current&&$(X.current).val(null).trigger("change"),Q.current.value=s==null?void 0:s.stock,$(N.current).modal("show")},Ie=async s=>{s.preventDefault();const t=$(c.current).val(),l=$(h.current).val(),i=$(p.current).val(),o={id:k.current.value||void 0,category_id:w.current.value,family_id:b.current.value,platform_id:m.current.value,name:n.current.value,summary:j.current.value,price:W.current.value,discount:J.current.value,applications:t,symbologies:l,technologies:i,description:q.current.value,stock:Q.current.value,specifications:JSON.stringify(A)},a=new FormData;for(const d in o)a.append(d,o[d]);a.append("features",JSON.stringify(je)),a.append("specifications",JSON.stringify(A)),a.append("attributes",JSON.stringify(T));const u=O.current.files[0];u&&a.append("image",u);let re=0;const Z=[];S.forEach((d,_)=>{d.toDelete||(d.file?(a.append(`gallery[${re}]`,d.file),re++):Z.push(d.id))}),Z.length>0&&Z.forEach((d,_)=>{a.append(`gallery_ids[${_}]`,d)});const ne=S.filter(d=>d.toDelete).map(d=>d.id);ne.length>0&&a.append("deleted_images",JSON.stringify(ne));let oe=0;const Y=[];R.forEach((d,_)=>{d.toDelete||(d.file?(a.append(`downloadables[${oe}]`,d.file),oe++):Y.push(d.id))}),Y.length>0&&Y.forEach((d,_)=>{a.append(`downloadable_ids[${_}]`,d)});const ce=R.filter(d=>d.toDelete).map(d=>d.id);ce.length>0&&a.append("deleted_downloadables",JSON.stringify(ce)),await G.save(a)&&($(f.current).dxDataGrid("instance").refresh(),$(N.current).modal("hide"),D([]),I([]))},Fe=async({id:s,value:t})=>{await G.boolean({id:s,field:"visible",value:t})&&$(f.current).dxDataGrid("instance").refresh()},H=async({id:s,field:t,value:l})=>{await G.boolean({id:s,field:t,value:l})&&$(f.current).dxDataGrid("instance").refresh()},ke=async s=>{const{isConfirmed:t}=await V.fire({title:"Eliminar curso",text:"¿Estás seguro de eliminar este curso?",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"});!t||!await G.delete(s)||$(f.current).dxDataGrid("instance").refresh()},Ae=()=>{$(K.current).modal("show")};return e.jsxs(e.Fragment,{children:[e.jsx(Pe,{gridRef:f,title:"Items",rest:G,toolBar:s=>{s.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(f.current).dxDataGrid("instance").refresh()}}),s.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Agregar",hint:"Agregar",onClick:()=>le()}}),s.unshift({widget:"dxButton",location:"after",options:{icon:"upload",text:"Importar Datos",hint:"Importar Datos",onClick:()=>Ae()}})},exportable:!0,exportableName:"Items",columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"category.name",caption:"Categoría",width:"120px",cellTemplate:(s,{data:t})=>{var l,i,o;s.html(ee.renderToString(e.jsxs(e.Fragment,{children:[e.jsx("b",{className:"d-block fst-italic text-muted",children:(l=t.collection)==null?void 0:l.name}),e.jsx("b",{className:"d-block",children:(i=t.category)==null?void 0:i.name}),e.jsx("small",{className:"text-muted",children:(o=t.subcategory)==null?void 0:o.name})]})))}},{dataField:"subcategory.name",caption:"Subcategoría",visible:!1},{dataField:"brand.name",caption:"Marca",width:"120px"},{dataField:"name",caption:"Nombre",minWidth:"300px",cellTemplate:(s,{data:t})=>{const i=((o,a)=>{if(!o)return"";const u=o.split(" ");return u.length>a?u.slice(0,a).join(" ")+"...":o})(t.summary,12);s.html(ee.renderToString(e.jsxs(e.Fragment,{children:[e.jsx("b",{children:t.name}),e.jsx("br",{}),e.jsx("span",{children:i})]})))}},{dataField:"final_price",caption:"Precio",dataType:"number",width:"75px",cellTemplate:(s,{data:t})=>{s.html(ee.renderToString(e.jsxs(e.Fragment,{children:[t.discount>0&&e.jsxs("small",{className:"d-block text-muted",style:{textDecoration:"line-through"},children:["S/.",pe(t.price)]}),e.jsxs("span",{children:["S/.",pe(t.discount>0?t.discount:t.price)]})]})))}},{dataField:"image",caption:"Imagen",width:"90px",allowFiltering:!1,cellTemplate:(s,{data:t})=>{z(s,e.jsx("img",{src:`/storage/images/item/${t.image}`,style:{width:"80px",height:"48px",objectFit:"cover",objectPosition:"center",borderRadius:"4px"},onError:l=>l.target.src="/api/cover/thumbnail/null"}))}},{dataField:"is_new",caption:"Nuevo",dataType:"boolean",width:"80px",cellTemplate:(s,{data:t})=>{const l=t.is_new===1||t.is_new==="1"||t.is_new===!0;z(s,e.jsx(B,{checked:l,onChange:i=>H({id:t.id,field:"is_new",value:i.target.checked?1:0})}))}},{dataField:"offering",caption:"En oferta",dataType:"boolean",width:"80px",cellTemplate:(s,{data:t})=>{const l=t.offering===1||t.offering==="1"||t.offering===!0;z(s,e.jsx(B,{checked:l,onChange:i=>H({id:t.id,field:"offering",value:i.target.checked?1:0})}))}},{dataField:"recommended",caption:"Recomendado",dataType:"boolean",width:"80px",cellTemplate:(s,{data:t})=>{const l=t.recommended===1||t.recommended==="1"||t.recommended===!0;z(s,e.jsx(B,{checked:l,onChange:i=>H({id:t.id,field:"recommended",value:i.target.checked?1:0})}))}},{dataField:"featured",caption:"Destacado",dataType:"boolean",width:"80px",cellTemplate:(s,{data:t})=>{const l=t.featured===1||t.featured==="1"||t.featured===!0;z(s,e.jsx(B,{checked:l,onChange:i=>H({id:t.id,field:"featured",value:i.target.checked?1:0})}))}},{dataField:"visible",caption:"Visible",dataType:"boolean",width:"80px",cellTemplate:(s,{data:t})=>{z(s,e.jsx(B,{checked:t.visible,onChange:l=>Fe({id:t.id,value:l.target.checked})}))}},{caption:"Acciones",width:"100px",cellTemplate:(s,{data:t})=>{s.css("text-overflow","unset"),s.append(de({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>le(t)})),s.append(de({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>ke(t.id)}))},allowFiltering:!1,allowExporting:!1}]}),e.jsx(me,{modalRef:N,title:xe?"Editar Producto":"Agregar Producto",onSubmit:Ie,size:"xl",children:e.jsxs("div",{className:"container-fluid",id:"principal-container",children:[e.jsx("input",{ref:k,type:"hidden"}),e.jsxs("ul",{className:"nav nav-tabs nav-tabs-custom mb-4",role:"tablist",children:[e.jsx("li",{className:"nav-item",children:e.jsxs("a",{className:"nav-link active","data-bs-toggle":"tab",href:"#tab-basic",role:"tab",children:[e.jsx("i",{className:"mdi mdi-information-outline me-2"}),"Información Básica"]})}),e.jsx("li",{className:"nav-item",children:e.jsxs("a",{className:"nav-link","data-bs-toggle":"tab",href:"#tab-classification",role:"tab",children:[e.jsx("i",{className:"mdi mdi-tag-multiple me-2"}),"Clasificación"]})}),e.jsx("li",{className:"nav-item",children:e.jsxs("a",{className:"nav-link","data-bs-toggle":"tab",href:"#tab-specs",role:"tab",children:[e.jsx("i",{className:"mdi mdi-cog me-2"}),"Especificaciones"]})}),e.jsx("li",{className:"nav-item",children:e.jsxs("a",{className:"nav-link","data-bs-toggle":"tab",href:"#tab-attributes",role:"tab",children:[e.jsx("i",{className:"mdi mdi-tag-text me-2"}),"Atributos"]})}),e.jsx("li",{className:"nav-item",children:e.jsxs("a",{className:"nav-link","data-bs-toggle":"tab",href:"#tab-media",role:"tab",children:[e.jsx("i",{className:"mdi mdi-image-multiple me-2"}),"Multimedia"]})}),e.jsx("li",{className:"nav-item",children:e.jsxs("a",{className:"nav-link","data-bs-toggle":"tab",href:"#tab-description",role:"tab",children:[e.jsx("i",{className:"mdi mdi-text-box me-2"}),"Descripción"]})})]}),e.jsxs("div",{className:"tab-content",children:[e.jsxs("div",{className:"tab-pane active",id:"tab-basic",role:"tabpanel",children:[e.jsx("div",{className:"row mb-3",children:e.jsx("div",{className:"col-md-12",children:e.jsx(U,{eRef:n,label:"Nombre del Producto",required:!0,placeholder:"Ingrese el nombre del producto"})})}),e.jsx("div",{className:"row mb-3",children:e.jsx("div",{className:"col-md-12",children:e.jsx(Ee,{eRef:j,label:"Resumen del Producto",rows:3,placeholder:"Descripción breve del producto"})})}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-4",children:e.jsx(U,{eRef:W,label:"Precio Regular (S/.)",type:"number",step:"0.01",min:"0",required:!0,placeholder:"0.00"})}),e.jsxs("div",{className:"col-md-4",children:[e.jsx(U,{eRef:J,label:"Precio con Descuento (S/.)",type:"number",step:"0.01",min:"0",placeholder:"0.00"}),e.jsx("small",{className:"text-muted",children:"Dejar vacío si no hay descuento"})]}),e.jsx("div",{className:"col-md-4",children:e.jsx(U,{label:"Stock Disponible",eRef:Q,type:"number",min:"0",placeholder:"0"})})]})]}),e.jsx("div",{className:"tab-pane",id:"tab-classification",role:"tabpanel",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs(Be,{eRef:w,label:"Categoría",required:!0,dropdownParent:"#principal-container",onChange:s=>ge(s.target.value),children:[e.jsx("option",{value:"",children:"Seleccione una categoría"}),F.map((s,t)=>e.jsx("option",{value:s.id,children:s.name},t))]})}),e.jsx("div",{className:"col-md-6",children:e.jsx(E,{eRef:b,label:"Familia",searchAPI:"/api/admin/families/paginate",searchBy:"name",dropdownParent:"#principal-container",onChange:s=>be(s.target.value)})}),e.jsx("div",{className:"col-md-6",children:e.jsx(E,{eRef:m,label:"Plataforma",searchAPI:"/api/admin/platforms/paginate",searchBy:"name",dropdownParent:"#principal-container"})}),e.jsx("div",{className:"col-md-6",children:e.jsx(E,{id:"applications",eRef:c,searchAPI:"/api/admin/applications/paginate",searchBy:"name",label:"Aplicaciones",dropdownParent:"#principal-container",tags:!0,multiple:!0})}),e.jsx("div",{className:"col-md-6",children:e.jsx(E,{id:"symbologies",eRef:h,searchAPI:"/api/admin/symbologies/paginate",searchBy:"name",label:"Simbologías",dropdownParent:"#principal-container",tags:!0,multiple:!0})}),e.jsx("div",{className:"col-md-6",children:e.jsx(E,{id:"technologies",eRef:p,searchAPI:"/api/admin/technologies/paginate",searchBy:"name",label:"Tecnologías",dropdownParent:"#principal-container",tags:!0,multiple:!0})})]})}),e.jsx("div",{className:"tab-pane",id:"tab-specs",role:"tabpanel",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("h6",{className:"mb-3",children:"Especificaciones Generales"}),e.jsx(ue,{ref:fe,label:"",structure:{description:""},value:A.filter(s=>s.type==="general"),onChange:s=>{const t=A.filter(i=>i.type==="technical"),l=[...s.map(i=>({...i,type:"general"})),...t];L(l)},placeholder:"Descripción general del producto"})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("h6",{className:"mb-3",children:"Especificaciones Técnicas"}),e.jsx(ue,{label:"",structure:{title:"",description:"",tooltip:""},value:A.filter(s=>s.type==="technical"),onChange:s=>{const l=[...A.filter(i=>i.type==="general"),...s.map(i=>({...i,type:"technical"}))];L(l)},placeholder:"Especificaciones técnicas del producto"})]})]})}),e.jsxs("div",{className:"tab-pane",id:"tab-attributes",role:"tabpanel",children:[T.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h6",{className:"text-muted mb-3",children:"Atributos del Producto"}),T.map((s,t)=>{const l=v==null?void 0:v.find(i=>i.id===s.attribute_id);return e.jsxs("div",{className:"row mb-3 align-items-end",children:[e.jsx("div",{className:"col-md-5",children:e.jsx("label",{className:"form-label fw-semibold",children:(l==null?void 0:l.name)||s.attribute_name})}),e.jsx("div",{className:"col-md-6",children:e.jsx("input",{type:"text",className:"form-control",placeholder:`Valor para ${(l==null?void 0:l.name)||s.attribute_name}`,value:s.value||"",onChange:i=>{const o=[...T];o[t].value=i.target.value,P(o)}})}),e.jsx("div",{className:"col-md-1",children:e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger w-100",onClick:()=>{P(T.filter((i,o)=>o!==t))},title:"Eliminar atributo",children:e.jsx("i",{className:"mdi mdi-delete"})})})]},t)})]}),e.jsx("div",{className:"card bg-light",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("h6",{className:"text-muted mb-3",children:[e.jsx("i",{className:"mdi mdi-plus-circle me-2"}),"Agregar Nuevo Atributo"]}),e.jsx("div",{className:"row",children:e.jsxs("div",{className:"col-md-12",children:[e.jsx(E,{eRef:X,id:"new-attribute-select",searchAPI:"/api/admin/attributes/paginate",searchBy:"name",label:"Seleccionar Atributo",dropdownParent:"#principal-container",placeholder:"Buscar o crear atributo...",tags:!0,onChange:s=>{const t=$(s.target).val();if(t){const l=t;let i=v==null?void 0:v.find(a=>a.id===l);if(i||(i={id:l,name:l}),T.some(a=>a.attribute_id===l||a.attribute_name===l||a.attribute_name===i.name))V.fire({icon:"warning",title:"Atributo duplicado",text:`El atributo "${i.name}" ya está en la lista`,confirmButtonText:"Entendido",timer:3e3});else{const a={attribute_id:i.id,attribute_name:i.name,value:""};P(u=>[...u,a]),console.log("✅ Atributo agregado:",a)}setTimeout(()=>{$(s.target).val(null).trigger("change")},100)}}}),e.jsxs("small",{className:"text-muted d-block mt-2",children:[e.jsx("i",{className:"mdi mdi-information-outline me-1"}),"Selecciona un atributo existente o escribe un nuevo nombre y presiona Enter."]})]})})]})})]}),e.jsxs("div",{className:"tab-pane",id:"tab-media",role:"tabpanel",children:[e.jsxs("div",{className:"row mb-4",children:[e.jsx("div",{className:"col-md-4",children:e.jsx($e,{eRef:O,label:"Imagen Principal",aspect:1})}),e.jsxs("div",{className:"col-md-8",children:[e.jsx("h6",{className:"mb-2",children:"Galería de Imágenes"}),e.jsx("input",{id:"input-item-gallery",ref:te,type:"file",multiple:!0,accept:"image/*",hidden:!0,onChange:ve}),e.jsx("div",{className:"border-2 border-dashed rounded p-4 text-center",style:{cursor:"pointer",backgroundColor:"#f8f9fa",minHeight:"120px",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s ease",borderWidth:"2px",borderStyle:"dashed"},onClick:()=>te.current.click(),onDrop:ye,onDragOver:ae,onMouseEnter:s=>{s.target.style.backgroundColor="#e9ecef",s.target.style.borderColor="#6c757d"},onMouseLeave:s=>{s.target.style.backgroundColor="#f8f9fa",s.target.style.borderColor="#dee2e6"},children:e.jsxs("div",{children:[e.jsx("i",{className:"mdi mdi-cloud-upload fs-3 text-muted mb-2 d-block"}),e.jsx("span",{className:"text-muted",children:"Arrastra y suelta imágenes aquí o haz clic para seleccionar"}),e.jsx("small",{className:"d-block text-muted mt-1",children:"Formatos soportados: JPG, PNG, GIF"})]})}),S.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("small",{className:"text-muted mb-2 d-block",children:[S.filter(s=>!s.toDelete).length," imagen",S.filter(s=>!s.toDelete).length!==1?"es":""," seleccionada",S.filter(s=>!s.toDelete).length!==1?"s":""]}),e.jsx("div",{className:"d-flex flex-wrap gap-2",children:S.filter(s=>!s.toDelete).map((s,t)=>{const l=S.findIndex(i=>i===s);return e.jsxs("div",{className:"position-relative border rounded",style:{width:"100px",height:"100px",overflow:"hidden"},children:[e.jsx("img",{src:`${s.url}`,alt:`preview-${l}`,className:"w-100 h-100",style:{objectFit:"cover"}}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm position-absolute",style:{top:"5px",right:"5px",width:"24px",height:"24px",padding:"0",fontSize:"12px",lineHeight:"1"},onClick:i=>Ne(i,l),title:"Eliminar imagen",children:"×"})]},l)})})]})]})]}),e.jsx("hr",{className:"my-4"}),e.jsx("div",{className:"row",children:e.jsxs("div",{className:"col-12",children:[e.jsx("h6",{className:"mb-3",children:"Archivos Descargables"}),e.jsx("input",{id:"input-item-downloadables",ref:ie,type:"file",multiple:!0,accept:".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.zip,.rar",hidden:!0,onChange:we}),e.jsx("div",{className:"border-2 border-dashed rounded p-4 text-center",style:{cursor:"pointer",backgroundColor:"#f8f9fa",minHeight:"120px",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s ease",borderWidth:"2px",borderStyle:"dashed"},onClick:()=>ie.current.click(),onDrop:Se,onDragOver:ae,onMouseEnter:s=>{s.target.style.backgroundColor="#e9ecef",s.target.style.borderColor="#6c757d"},onMouseLeave:s=>{s.target.style.backgroundColor="#f8f9fa",s.target.style.borderColor="#dee2e6"},children:e.jsxs("div",{children:[e.jsx("i",{className:"mdi mdi-file-upload fs-3 text-muted mb-2 d-block"}),e.jsx("span",{className:"text-muted",children:"Arrastra y suelta archivos aquí o haz clic para seleccionar"}),e.jsx("small",{className:"d-block text-muted mt-1",children:"Formatos soportados: PDF, DOC, XLS, PPT, TXT, ZIP, RAR"}),e.jsxs("small",{className:"d-block text-warning mt-1",children:[e.jsx("i",{className:"mdi mdi-alert-circle me-1"}),"Tamaño máximo por archivo: 10MB"]})]})}),R.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("small",{className:"text-muted mb-2 d-block",children:[R.filter(s=>!s.toDelete).length," archivo",R.filter(s=>!s.toDelete).length!==1?"s":""," seleccionado",R.filter(s=>!s.toDelete).length!==1?"s":""]}),e.jsx("div",{className:"list-group",children:R.filter(s=>!s.toDelete).map((s,t)=>{const l=R.findIndex(i=>i===s);return e.jsxs("div",{className:"list-group-item d-flex align-items-center justify-content-between",children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{className:`mdi ${De(s.name)} fs-4 text-primary me-3`}),e.jsxs("div",{children:[e.jsx("div",{className:"fw-medium",children:s.name}),e.jsx("small",{className:"text-muted",children:s.size?Ce(s.size):"Tamaño desconocido"})]})]}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[s.url&&!s.file&&e.jsx("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm btn-outline-primary",title:"Descargar archivo",children:e.jsx("i",{className:"mdi mdi-download"})}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:i=>Re(i,l),title:"Eliminar archivo",children:e.jsx("i",{className:"mdi mdi-delete"})})]})]},l)})})]})]})})]}),e.jsx("div",{className:"tab-pane",id:"tab-description",role:"tabpanel",children:e.jsx(_e,{eRef:q,label:"Descripción Detallada",placeholder:"Escriba una descripción detallada del producto..."})})]})]})}),e.jsx(me,{modalRef:K,title:"Importar Datos",size:"sm",children:e.jsx(Oe,{gridRef:f,modalRef:K})})]})};Me((F,x)=>{ze.createRoot(F).render(e.jsx(Te,{...x,title:"Items",children:e.jsx(Le,{...x})}))});
