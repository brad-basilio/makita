import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as m}from"./index-BH53Isel.js";import{P as $}from"./PostsRest-B-gKT_Ra.js";import{C as F}from"./chevron-down-DS-mdh9v.js";import{S as O}from"./search-TwiiKGP5.js";import{C as L}from"./check-DQ7QoS0v.js";import{G as T}from"./Global-BD3biX1l.js";import"./index-yBjzXJbu.js";import"./BasicRest-CD3GL1x9.js";import"./main-BvVILmTO.js";import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";import"./index-CMHsc23u.js";import"./index-rimy3MAc.js";import"./index-fNjTmf9T.js";import"./createLucideIcon-Cy5Ya80P.js";const B=t=>{if(!t)return"";const i=new Date(t);return Number.isNaN(i.getTime())?t:new Intl.DateTimeFormat("es-ES",{day:"numeric",month:"long",year:"numeric"}).format(i)};function A({data:t,flex:i=!1,post:l,featured:d=!1}){var x,u;return e.jsx("article",{className:`group relative lg:p-4 font-title ${d?"h-full":""}`,children:e.jsxs("a",{href:`/post/${l==null?void 0:l.slug}`,className:`block ${i?"md:flex md:gap-4":""}`,children:[e.jsx("div",{className:`relative bg-[#E7E7E7] aspect-[4/3] overflow-hidden rounded-lg ${i?"w-full md:w-2/5":"w-full aspect-square"}`,children:e.jsx("img",{src:`/storage/images/post/${l==null?void 0:l.image}`,alt:l==null?void 0:l.name,fill:!0,className:"object-cover h-full transition-transform duration-300 group-hover:scale-105 w-full"})}),e.jsxs("div",{className:`flex flex-col justify-center py-2 space-y-1 ${i?"w-full md:w-3/5 mt-0 gap-1":""}`,children:[e.jsx("span",{className:"customtext-primary opacity-90 text-base 2xl:text-base line-clamp-1 ",children:((x=l==null?void 0:l.post_category)==null?void 0:x.name)??((u=l==null?void 0:l.category)==null?void 0:u.name)}),e.jsx("h3",{className:"text-base md:text-lg xl:text-2xl line-clamp-3 lg:line-clamp-2 2xl:text-2xl font-semibold customtext-neutral-dark group-hover:customtext-primary leading-tight",children:l==null?void 0:l.name}),e.jsx("p",{className:"line-clamp-2  customtext-neutral-dark opacity-85 text-sm md:text-md font-title 2xl:text-base !leading-snug",children:l==null?void 0:l.summary}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-[#219FB9]",children:[e.jsx("time",{children:B(l==null?void 0:l.post_date)}),(t==null?void 0:t["bool:show_seen"])&&e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"mdi mdi-circle-medium"}),e.jsx("span",{children:"Leído hace 5 minutos"})]})]})]})]})})}const z=({options:t=[],placeholder:i="Select an option",onChange:l,valueKey:d,labelKey:x,label:u,labelClass:C,className:w,disabled:N=!1})=>{const[f,b]=m.useState(!1),[o,g]=m.useState(null),[j,_]=m.useState(""),p=m.useRef(null),v=t.length>0&&typeof t[0]=="object",S=v?d||Object.keys(t[0])[0]:null,k=v?x||Object.keys(t[0])[1]:null,r=t.map(s=>v?{value:s[S],label:s[k]}:{value:s,label:s}).filter(s=>s.label.toLowerCase().includes(j.toLowerCase()));m.useEffect(()=>{const s=n=>{p.current&&!p.current.contains(n.target)&&b(!1)};return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[]);const c=s=>{g(s),l(s.value),b(!1)};return e.jsxs("div",{className:"relative w-full",ref:p,children:[u&&e.jsx("label",{className:`block text-sm mb-1 customtext-neutral-dark ${C}`,children:u}),e.jsxs("button",{className:`w-full relative text-start  px-4 py-3 border customtext-neutral-dark   rounded-xl focus:ring-0 focus:outline-0   transition-all duration-300 ${w}`,onClick:()=>b(!f),"aria-haspopup":"listbox","aria-expanded":f,disabled:N,children:[e.jsx("span",{className:"block truncate",children:o?o.label:i}),e.jsx("span",{className:"absolute inset-y-0 right-0 flex items-center justify-center py-3 pr-2 pointer-events-none",children:e.jsx(F,{className:`w-5 h-5 customtext-neutral-dark transition-transform duration-200 ${f?"rotate-180":""}`})})]}),f&&e.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white rounded-lg shadow-lg max-h-60 overflow-auto",children:[e.jsx("div",{className:"sticky top-0 bg-white p-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(O,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),e.jsx("input",{type:"text",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Search options...",value:j,onChange:s=>_(s.target.value)})]})}),e.jsx("ul",{className:"py-1",role:"listbox",children:r.map(s=>e.jsxs("li",{className:`px-4 py-2 cursor-pointer flex items-center justify-between 
                                    ${o&&o.value===s.value?"bg-blue-500 text-white":"hover:bg-gray-100"}`,onClick:()=>c(s),role:"option","aria-selected":o&&o.value===s.value,children:[e.jsx("span",{className:"block truncate",children:s.label}),o&&o.value===s.value&&e.jsx(L,{className:"w-5 h-5"})]},s.value))})]})]})},P=new $;function Z({data:t,posts:i,setPosts:l,headerPosts:d,postsLatest:x,filteredData:u,loading:C,setLoading:w,isFilter:N,setIsFilter:f}){const[b,o]=m.useState([]),[g,j]=m.useState({category_id:"",post_date:"",name:""});console.log("BLOG LAST POSTS",x);const[_,p]=m.useState(!0),v=a=>{const r=[];return a.category_id&&r.push(["post_category_id","=",a.category_id]),a.post_date&&(console.log("Fecha seleccionada:",a.post_date),r.push(["post_date","=",a.post_date])),a.name&&(console.log("Nombre seleccionado:",a.name),r.push(["name","contains",a.name])),r},S=async()=>{w(!0);try{const a=v(g),r=g.category_id||g.post_date||g.name,c={with:"postCategory",filter:a};console.log(c);const s=await P.paginate(c);console.log(s),l(s.data),f(!!r)}catch(a){console.error("Error fetching posts:",a)}finally{w(!1)}};m.useEffect(()=>{(()=>{const r=[];Array.isArray(d)&&r.push(...d),Array.isArray(x)&&r.push(...x),Array.isArray(i)&&r.push(...i);const c=new Map;r.forEach(n=>{const h=(n==null?void 0:n.postCategory)||(n==null?void 0:n.post_category)||(n==null?void 0:n.category);h&&h.id&&(c.has(h.id)||c.set(h.id,{id:h.id,name:h.name}));const E=(n==null?void 0:n.categories)||(n==null?void 0:n.post_categories);Array.isArray(E)&&E.forEach(y=>{y&&y.id&&!c.has(y.id)&&c.set(y.id,{id:y.id,name:y.name})})});const s=Array.from(c.values());s.length===0&&u&&Array.isArray(u.categories)?o(u.categories):o(s)})()},[d,x,i,u]),m.useEffect(()=>{_?p(!1):S()},[g]);const k=(a,r)=>{j(c=>({...c,[a]:r}))};return m.useEffect(()=>{console.log("BlogHeader - posts actualizados:",i)},[i]),e.jsx("main",{className:"bg-white font-title",children:e.jsxs("section",{className:`px-primary 2xl:px-0 2xl:max-w-7xl mx-auto ${N?"pt-8":"py-8"}`,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:`font-title text-3xl md:text-5xl 2xl:text-[56px] font-bold tracking-normal ${(t==null?void 0:t.class_title)||"customtext-neutral-dark"}`,children:t!=null&&t.title?e.jsx("span",{dangerouslySetInnerHTML:{__html:t.title},className:"leading-tight block",style:{lineHeight:"1.1"}}):e.jsxs(e.Fragment,{children:["Descubre lo mejor:",e.jsx("br",{}),"Publicaciones sobre el mundo de ",T.APP_NAME]})}),(t==null?void 0:t.description)&&e.jsx("p",{className:"customtext-neutral-dark opacity-80 text-base 2xl:text-xl font-title",children:t==null?void 0:t.description})]}),e.jsxs("div",{className:"mt-8 flex flex-col md:flex-row gap-4 justify-between",children:[e.jsxs("div",{className:"relative md:w-6/12 flex items-center",children:[e.jsx("input",{type:"search",placeholder:"Buscar publicación",className:"w-full px-4 relative py-3 border customtext-neutral-dark  border-neutral-ligth rounded-md text-lg focus:ring-0 focus:outline-0   transition-all duration-300",onChange:a=>k("name",a.target.value)}),e.jsx("div",{className:"absolute right-3 p-2 rounded-md bg-neutral-dark",children:e.jsx(O,{className:" h-6 w-6 text-white"})})]}),e.jsxs("div",{className:"flex w-full gap-2 md:gap-4 md:w-5/12",children:[e.jsx("div",{className:"w-1/2 md:w-full",children:e.jsx(z,{options:b,placeholder:"Todas las categorías",onChange:a=>{j(r=>({...r,category_id:a}))},labelKey:"name",valueKey:"id",className:"w-full px-4 py-3 text-lg  border-neutral-ligth !rounded-md focus:ring-0 focus:outline-0   transition-all duration-300"})}),e.jsx("input",{type:"date",className:"w-1/2 md:w-full px-4 py-3 border customtext-neutral-dark  border-neutral-ligth text-lg !rounded-md focus:ring-0 focus:outline-0   transition-all duration-300",onChange:a=>{k("post_date",a.target.value)}})]})]}),!N&&e.jsxs("div",{className:"mt-8 flex gap-8 py-[2.5%] rounded-2xl",children:[e.jsx("div",{className:"w-full md:w-1/2",children:e.jsx(A,{data:t,featured:!0,post:d[0]})}),e.jsx("div",{className:"hidden md:flex space-y-4  flex-col w-1/2",children:d.slice(1,3).map(a=>e.jsx(A,{data:t,flex:!0,post:a},a.id))})]})]})})}export{A as B,Z as a};
