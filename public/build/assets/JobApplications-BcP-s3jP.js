var S=Object.defineProperty;var y=(o,n,s)=>n in o?S(o,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[n]=s;var h=(o,n,s)=>y(o,typeof n!="symbol"?n+"":n,s);import{j as i}from"./AboutSimple-Cf8x2fCZ.js";import{r as l}from"./index-BH53Isel.js";import{c as B}from"./ReactAppend-DTVVXReZ.js";import{B as V}from"./Base-BFPMzJYQ.js";import{C as k}from"./CreateReactScript-BoGwggCx.js";import{T as G}from"./Table-DitbKwtZ.js";import{I as x}from"./InputFormGroup-D5I6zpZc.js";import{R as b}from"./ReactAppend-D7S498fx.js";import{D as R}from"./DxButton-DV0H-ZcL.js";import{S as v}from"./SwitchFormGroup-CGYpv_4Q.js";import{S as N}from"./ProductCard-Ap6bpF1Q.js";import{B as _}from"./BasicRest-B3rfI5GY.js";import"./server.browser-Bf4gQIc7.js";import{T as M}from"./TextareaFormGroup-DVzYJtLM.js";import{M as A}from"./Modal-CIqmjseY.js";import"./index-yBjzXJbu.js";import"./index-fNjTmf9T.js";import"./Global-ErywZRdd.js";import"./tippy-react.esm-BWiGTO87.js";import"./index-rimy3MAc.js";/* empty css              */import"./Logout-7s5dsuEK.js";import"./main-BvVILmTO.js";import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";import"./MenuItemContainer-C_dOKkRB.js";import"./index.esm-DAJ8Pwbk.js";import"./index-xsH4HHeE.js";/* empty css               */import"./General-BmbBKdsB.js";import"./LaravelSession-Dz9cpV3l.js";import"./index-CMHsc23u.js";class I extends _{constructor(){super(...arguments);h(this,"path","admin/job-applications");h(this,"hasFiles",!0)}}const c=new I,O=({})=>{const o=l.useRef(),n=l.useRef(),s=l.useRef(),m=l.useRef(),p=l.useRef(),d=l.useRef(),u=l.useRef(),[j,w]=l.useState(!1),g=e=>{e!=null&&e.id?w(!0):w(!1),s.current.value=(e==null?void 0:e.id)??"",m.current.value=(e==null?void 0:e.name)??"",p.current.value=(e==null?void 0:e.phone)??"",d.current.value=(e==null?void 0:e.email)??"",u.current.value=(e==null?void 0:e.notes)??"",$(n.current).modal("show")},C=async e=>{e.preventDefault();const t={id:s.current.value||void 0,name:m.current.value,phone:p.current.value,email:d.current.value,notes:u.current.value};let r=t;if(c.hasFiles){const a=new FormData;t.id&&a.append("id",t.id),a.append("name",t.name||""),a.append("phone",t.phone||""),a.append("email",t.email||""),a.append("notes",t.notes||""),r=a}await c.save(r)&&($(o.current).dxDataGrid("instance").refresh(),$(n.current).modal("hide"))},F=async e=>{const{isConfirmed:t}=await N.fire({title:"Eliminar solicitud",text:"¿Estás seguro de eliminar esta solicitud de empleo?",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"});!t||!await c.delete(e)||$(o.current).dxDataGrid("instance").refresh()},E=e=>{window.open(`/api/admin/job-applications/media/${e}`,"_blank")},D=async({id:e,value:t})=>{await c.boolean({id:e,field:"visible",value:t}),$(o.current).dxDataGrid("instance").refresh()},T=async({id:e,field:t,value:r})=>{await c.boolean({id:e,field:t,value:r})&&$(o.current).dxDataGrid("instance").refresh()};return i.jsxs(i.Fragment,{children:[i.jsx(G,{gridRef:o,title:"Solicitudes de Empleo",rest:c,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(o.current).dxDataGrid("instance").refresh()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"name",caption:"Nombre",width:"20%"},{dataField:"email",caption:"Email",width:"20%"},{dataField:"phone",caption:"Teléfono",width:"15%"},{dataField:"cv_file",caption:"CV",width:"10%",allowFiltering:!1,cellTemplate:(e,{data:t})=>{t.cv_file?b(e,i.jsxs("button",{className:"btn btn-xs btn-soft-primary",onClick:()=>E(t.cv_file),title:"Descargar CV",children:[i.jsx("i",{className:"fa fa-download"})," CV"]})):e.html('<i class="text-muted">Sin CV</i>')}},{dataField:"seen",caption:"Visto",width:"10%",cellTemplate:(e,{data:t})=>{const r=t.seen===1||t.seen==="1"||t.seen===!0;b(e,i.jsx(v,{checked:r,onChange:f=>T({id:t.id,field:"seen",value:f.target.checked?1:0})}))}},{dataField:"visible",caption:"Visible",width:"10%",cellTemplate:(e,{data:t})=>{b(e,i.jsx(v,{checked:t.visible,onChange:r=>D({id:t.id,value:r})}))}},{dataField:"created_at",caption:"Fecha",width:"15%",cellTemplate:(e,{data:t})=>{e.html(moment(t.created_at).format("DD/MM/YYYY HH:mm"))}},{caption:"Acciones",width:"8%",cellTemplate:(e,{data:t})=>{e.css("text-overflow","unset"),e.append(R({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>g(t)})),e.append(R({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>F(t.id)}))},allowFiltering:!1,allowExporting:!1}]}),i.jsx(A,{modalRef:n,title:j?"Editar solicitud":"Ver solicitud",onSubmit:C,size:"md",children:i.jsxs("div",{className:"row",id:"principal-container",children:[i.jsx("input",{ref:s,type:"hidden"}),i.jsx(x,{eRef:m,label:"Nombre completo",col:"col-md-12",readOnly:!0}),i.jsx(x,{eRef:d,label:"Email",col:"col-md-12",readOnly:!0}),i.jsx(x,{eRef:p,label:"Teléfono",col:"col-md-12",readOnly:!0}),i.jsx(M,{eRef:u,label:"Notas internas",rows:3})]})})]})};k((o,n)=>{B.createRoot(o).render(i.jsx(V,{...n,title:"Solicitudes de Empleo",children:i.jsx(O,{...n})}))});
