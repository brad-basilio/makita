import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as o,R as V}from"./index-BH53Isel.js";import"./ProductNavigation-CR30xqv8.js";import{I as ge}from"./ItemsRest-DGjwRLrz.js";import{A as g}from"./ArrayJoin-2k6ba35P.js";import{L as pe}from"./Loading-B-FwDSWi.js";import{N as he}from"./NoResult-C9qZVva5.js";import{S as fe}from"./SelectForm-G0J6yhhv.js";import"./ProductCard-Ap6bpF1Q.js";import{P as be}from"./ProductCardColors-BNCA_mqI.js";import{m as n}from"./main-BvVILmTO.js";import{M as ye}from"./PaymentModal-Bxx5p2o_.js";import{F as je}from"./filter-Ci9tsc_e.js";import{C as I}from"./chevron-left-B2s3ZsB7.js";import{C as O}from"./chevron-right-Ckt5D2ka.js";import{X as z}from"./x-DBMwyD6F.js";import{C as P}from"./chevron-up-D78jyEhP.js";import{S as B}from"./search-TwiiKGP5.js";import"./index-yBjzXJbu.js";import"./HeaderSearch-B_41BEro.js";import"./CartItemRow-4VUVjpPz.js";import"./Number2Currency-e57Tgsuk.js";import"./tippy-react.esm-BWiGTO87.js";import"./index-rimy3MAc.js";import"./index-fNjTmf9T.js";import"./proxy-BTYtmp9V.js";import"./trash-2-DK1wnsDn.js";import"./createLucideIcon-Cy5Ya80P.js";import"./plus-Bot15Khs.js";import"./index-CFtDjG4d.js";import"./eye-CKCH9ORv.js";import"./BasicRest-B3rfI5GY.js";import"./index-CMHsc23u.js";import"./chevron-down-DS-mdh9v.js";import"./check-DQ7QoS0v.js";/* empty css              */import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";import"./index-Chjiymov.js";const we=new ge,us=({items:Ne,data:d,filteredData:Ce,cart:q,setCart:H})=>{const[h,K]=o.useState([]),[f,W]=o.useState([]),[ve,Y]=o.useState([]),[b,Z]=o.useState([]),[D,J]=o.useState([]),[u,_]=o.useState({collection:!(d!=null&&d.collection),marca:!!(d!=null&&d.brand),precio:!0,categoria:!!(d!=null&&d.category),colores:!!(d!=null&&d.color)}),[U,X]=o.useState(window.innerWidth<1024),[Q,S]=o.useState([]);o.useEffect(()=>{const s=()=>{X(window.innerWidth<1024)};return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]);const y=s=>{_(U?t=>{const a={collection:!1,marca:!1,precio:!1,categoria:!1,colores:!1};return a[s]=!t[s],a}:t=>({...t,[s]:!t[s]}))},ee=()=>{j({collection_id:[],category_id:[],brand_id:[],subcategory_id:[],price:null,name:null,sort_by:"created_at",order:"desc"}),S([])},[c,j]=o.useState({collection_id:n.GET.collection?n.GET.collection.split(","):[],category_id:n.GET.category?n.GET.category.split(","):[],brand_id:n.GET.brand?n.GET.brand.split(","):[],subcategory_id:n.GET.subcategory?n.GET.subcategory.split(","):[],collection_id:n.GET.collection?n.GET.collection.split(","):[],category_id:n.GET.category?n.GET.category.split(","):[],brand_id:n.GET.brand?n.GET.brand.split(","):[],subcategory_id:n.GET.subcategory?n.GET.subcategory.split(","):[],price:null,name:n.GET.search||null,name:n.GET.search||null,sort_by:"created_at",order:"desc"}),[w,se]=o.useState([]),[te,k]=o.useState(!0),[l,re]=o.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:21,from:0,to:0}),ae=c.collection_id.length>0||c.category_id.length>0||c.brand_id.length>0||c.subcategory_id.length>0||c.price!==null||c.name!==null,le=s=>{var a,i;const t=[];if(s.collection_id.length>0){const r=s.collection_id.map(m=>["collection.slug","=",m]);t.push(g(r,"or"))}if(s.category_id.length>0){const r=s.category_id.map(m=>["category.slug","=",m]);t.push(g(r,"or"))}if(s.subcategory_id.length>0){const r=s.subcategory_id.map(m=>["subcategory.slug","=",m]);t.push(g(r,"or"))}if(s.brand_id.length>0){const r=s.brand_id.map(m=>["brand.slug","=",m]);t.push(g(r,"or"))}return(a=s.price)!=null&&a.min&&((i=s.price)!=null&&i.max)&&t.push([["final_price",">=",s.price.min],"or",["final_price","<=",s.price.max]]),s.name&&t.push(["name","contains",s.name]),g(t,"and")},E=async(s=1)=>{k(!0);try{const t=le(c),a={},i={filter:t,sort:c.sort,skip:(s-1)*l.itemsPerPage,take:l.itemsPerPage,requireTotalCount:!0,filterSequence:Q},r=await we.paginate(i);se(r.data),re({currentPage:s,totalPages:Math.ceil(r.totalCount/l.itemsPerPage),totalItems:r.totalCount,itemsPerPage:l.itemsPerPage,from:(s-1)*l.itemsPerPage+1,to:Math.min(s*l.itemsPerPage,r.totalCount)}),console.log(r),K(r==null?void 0:r.summary.collections),W(r==null?void 0:r.summary.brands),Z(r==null?void 0:r.summary.categories),Y(r==null?void 0:r.summary.subcategories),J(r==null?void 0:r.summary.priceRanges)}catch(t){console.error("Error fetching products:",t)}finally{k(!1)}};o.useEffect(()=>{E(l.currentPage)},[c]);const x=s=>{s>=1&&s<=l.totalPages&&E(s)},T=()=>{const s=[],t=l.totalPages,a=l.currentPage,i=2;for(let r=1;r<=t;r++)r===1||r===t||r>=a-i&&r<=a+i?s.push(r):(r===a-i-1||r===a+i+1)&&s.push("...");return s.filter((r,m,L)=>r!=="..."||L[m-1]!=="...")},p=(s,t)=>{S(a=>{let i=!1;if(s==="price"?i=!!t:i=!(Array.isArray(c[s])?c[s]:[]).includes(t),a.includes(s)&&i)return a;if(!a.includes(s)&&i)return[...a,s];if(!i){let r=!1;return s==="price"?r=!t:r=(Array.isArray(c[s])?[...c[s]]:[]).filter(xe=>xe!==t).length===0,r?a.filter(m=>m!==s):a}return a}),j(a=>{if(s==="price")return{...a,price:a.price&&a.price.min===(t==null?void 0:t.min)&&a.price.max===(t==null?void 0:t.max)?null:t};const i=Array.isArray(a[s])?a[s]:[],r=i.includes(t)?i.filter(m=>m!==t):[...i,t];return{...a,[s]:r}})},ie=[{value:"created_at:desc",label:"Más reciente"},{value:"created_at:asc",label:"Mas antiguo"},{value:"final_price:asc",label:"Precio: Menor a Mayor"},{value:"final_price:desc",label:"Precio: Mayor a Menor"},{value:"name:asc",label:"Nombre: A-Z"},{value:"name:desc",label:"Nombre: Z-A"}],[F,oe]=o.useState(""),[G,ne]=o.useState(""),[ce,Pe]=o.useState(""),N=h==null?void 0:h.filter(s=>s.name.toLowerCase().includes(G.toLowerCase())),C=b==null?void 0:b.filter(s=>s.name.toLowerCase().includes(F.toLowerCase()));f==null||f.filter(s=>s.name.toLowerCase().includes(ce.toLowerCase()));const[_e,Se]=o.useState(!1),[me,$]=o.useState(!1),[A,R]=o.useState(!1),de=()=>{$(!0),setTimeout(()=>R(!0),10),document.body.style.overflow="hidden"},v=()=>{R(!1),setTimeout(()=>$(!1),300),document.body.style.overflow="auto"},ue={overlay:{backgroundColor:A?"rgba(0, 0, 0, 0.5)":"rgba(0, 0, 0, 0)",zIndex:50,transition:"background-color 300ms ease-in-out"},content:{top:"auto",left:"0",right:"0",bottom:"0",borderRadius:"1rem 1rem 0 0",border:"none",padding:"0",height:"75vh",transform:A?"translateY(0)":"translateY(100%)",transition:"transform 300ms ease-in-out",willChange:"transform"}},M=()=>e.jsxs("div",{className:"flex-1 overflow-y-auto px-4 pb-20 lg:pb-0 lg:px-0",children:[e.jsxs("div",{className:"sticky top-0 bg-white py-4 border-b flex justify-between items-center lg:hidden",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Filtros"}),e.jsx("button",{onClick:v,children:e.jsx(z,{className:"h-6 w-6"})})]}),e.jsx("p",{className:"customtext-primary text-2xl font-bold pb-4 mb-4 border-b lg:block hidden",children:"Combina como desees tu sala"}),ae&&e.jsx("div",{className:"mb-4",children:e.jsxs("button",{onClick:ee,className:"w-full bg-gray-100 hover:bg-gray-200 text-gray-800 font-medium py-2 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2",children:[e.jsx(z,{size:16}),e.jsx("span",{children:"Limpiar todos los filtros"})]})}),e.jsxs("div",{className:"mt-2 mb-4",children:[e.jsxs("button",{onClick:()=>y("collection"),className:"flex items-center justify-between w-full mb-2 p-2 lg:p-0",children:[e.jsx("span",{className:"font-medium",children:"Colecciones"}),e.jsx(P,{className:`h-5 w-5 transform transition-transform ${u.collection?"":"-rotate-180"}`})]}),u.collection&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative hidden md:flex",children:[e.jsx(B,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full pl-10 pr-4 py-3 border rounded-xl focus:ring-0 focus:outline-0",value:G,onChange:s=>ne(s.target.value)})]}),e.jsx("div",{className:"max-h-[200px] xl:max-h-none overflow-y-auto space-y-1 md:space-y-2",children:N==null?void 0:N.map(s=>{var a;const t=(a=c.collection_id)==null?void 0:a.includes(s.slug);return e.jsx("div",{className:`group flex items-center gap-3 p-2 rounded-lg ${t?"bg-secondary":"hover:bg-gray-50"}`,children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"h-5 w-5 rounded border-gray-300 accent-primary hidden ",onChange:()=>p("collection_id",s.slug),checked:t}),e.jsx("img",{src:`/storage/images/collection/${s.image}`,onError:i=>i.target.src="assets/img/noimage/no_imagen_circular.png",className:"w-8 h-8 rounded-full object-cover",alt:s.name}),e.jsx("span",{className:"text-sm lg:text-base",children:s.name})]})},s.id)})})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("button",{onClick:()=>y("categoria"),className:"flex items-center justify-between w-full mb-2 p-2 lg:p-0",children:[e.jsx("span",{className:"font-medium",children:"Categorías"}),e.jsx(P,{className:`h-5 w-5 transform transition-transform ${u.categoria?"":"-rotate-180"}`})]}),u.categoria&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative hidden md:flex",children:[e.jsx(B,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full pl-10 pr-4 py-3 border rounded-xl focus:ring-0 focus:outline-0",value:F,onChange:s=>oe(s.target.value)})]}),e.jsx("div",{className:"max-h-[200px] xl:max-h-none overflow-y-auto space-y-1 md:space-y-2",children:C==null?void 0:C.map(s=>{var a;const t=(a=c.category_id)==null?void 0:a.includes(s.slug);return e.jsx("div",{className:`group flex items-center gap-3 p-2 rounded-lg ${t?"bg-secondary":"hover:bg-gray-50"}`,children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"h-5 w-5 rounded border-gray-300 accent-primary hidden",onChange:()=>p("category_id",s.slug),checked:t}),e.jsx("img",{src:`/storage/images/category/${s.image}`,onError:i=>i.target.src="assets/img/noimage/no_imagen_circular.png",className:"w-8 h-8 rounded-full object-cover",alt:s.name}),e.jsx("span",{className:"text-sm lg:text-base",children:s.name})]})},s.id)})})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("button",{onClick:()=>y("precio"),className:"flex items-center justify-between w-full mb-2 p-2 lg:p-0",children:[e.jsx("span",{className:"font-medium",children:"Precio"}),e.jsx(P,{className:`h-5 w-5 transform transition-transform ${u.precio?"":"-rotate-180"}`})]}),u.precio&&e.jsx("div",{className:"max-h-[200px] xl:max-h-none overflow-y-auto space-y-1 md:space-y-2",children:D.map(s=>{var a,i;const t=((a=c.price)==null?void 0:a.min)===s.min&&((i=c.price)==null?void 0:i.max)===s.max;return e.jsxs("label",{className:"flex items-center gap-2 p-2 rounded-lg hover:bg-gray-50 cursor-pointer",onClick:()=>{t?p("price",null):p("price",s)},children:[e.jsx("div",{className:`w-[18px] h-[18px] rounded-full border ${t?"border-primary":"border-gray-300"} flex items-center justify-center`,children:t&&e.jsx("div",{className:"w-3 h-3 rounded-full bg-primary"})}),e.jsx("span",{className:"text-sm lg:text-base",children:`S/ ${s.min} - S/ ${s.max}`})]},`${s.min}-${s.max}`)})})]}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t p-4 h-20 flex items-center lg:hidden",children:e.jsx("button",{className:"w-full bg-primary text-white py-3 rounded-xl font-bold hover:bg-primary-dark transition-colors",onClick:v,children:"Ver resultados"})})]});return e.jsxs(e.Fragment,{children:[e.jsx(ye,{isOpen:me,onRequestClose:v,style:ue,closeTimeoutMS:300,ariaHideApp:!1,shouldCloseOnOverlayClick:!0,shouldCloseOnEsc:!0,children:M()}),e.jsx("section",{className:"py-6 font-font-general customtext-primary",children:e.jsxs("div",{className:"mx-auto px-primary",children:[e.jsx("p",{className:"customtext-primary text-3xl font-bold mb-2 xl:hidden",children:"Combina como desees tu sala"}),e.jsxs("div",{className:"relative flex flex-col xl:flex-row gap-10",children:[e.jsx("div",{className:"hidden xl:block xl:w-1/4 lg:bg-white lg:p-0 xl:rounded-lg xl:h-max",children:M()}),e.jsxs("div",{className:"w-full pb-4",children:[e.jsxs("div",{className:"mb-4 lg:mb-8 w-full gap-5 xl:flex xl:flex-row xl:justify-between items-start",children:[e.jsxs("div",{className:"flex flex-row justify-between items-end gap-5",children:[e.jsxs("div",{className:"flex flex-col xl:flex-row xl:justify-between gap-2 xl:items-center lg:max-w-xs w-full",children:[e.jsx("label",{className:"font-semibold text-base 2xl:text-lg w-auto",children:"Ordenar por"}),e.jsx("div",{className:"min-w-52",children:e.jsx(fe,{options:ie,placeholder:"Recomendados",onChange:s=>{const[t,a]=s.split(":"),i=[{selector:t,desc:a==="desc"}];j(r=>({...r,sort:i}))},labelKey:"label",valueKey:"value",className:"border-primary rounded-full customtext-primary w-full"})})]}),e.jsx("div",{children:e.jsx("button",{onClick:de,className:"flex xl:hidden bg-primary text-white rounded-full p-3 shadow-lg z-40 items-center justify-center","aria-label":"Abrir filtros",children:e.jsx(je,{className:"w-6 h-6"})})})]}),e.jsx("div",{className:"hidden xl:flex customtext-primary font-semibold w-full lg:w-auto",children:e.jsxs("div",{className:"flex gap-3 items-center w-full",children:[e.jsx("div",{className:"customtext-primary font-semibold",children:e.jsxs("nav",{className:"flex items-center gap-x-1 min-w-max",children:[e.jsx("button",{className:`p-0 inline-flex items-center ${l.currentPage===1?"opacity-50 cursor-not-allowed":""}`,onClick:()=>x(l.currentPage-1),disabled:l.currentPage===1,children:e.jsx(I,{})}),T().map((s,t)=>e.jsx(V.Fragment,{children:s==="..."?e.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):e.jsx("button",{className:`w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 
                                           
                                            ${s===l.currentPage?"bg-primary text-white":"bg-transparent hover:text-white hover:bg-primary"}`,onClick:()=>x(s),children:s})},t)),e.jsx("button",{className:`p-0 inline-flex items-center ${l.currentPage===l.totalPages?"opacity-50 cursor-not-allowed":""}`,onClick:()=>x(l.currentPage+1),disabled:l.currentPage===l.totalPages,children:e.jsx(O,{})})]})}),e.jsx("div",{children:e.jsxs("p",{className:"font-semibold",children:[l.from," - ",l.to," ","de ",l.totalItems," ","Resultados"]})})]})})]}),te?e.jsx(pe,{}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 md:gap-6 xl:gap-8 gap-y-2 lg:gap-y-3 transition-all duration-300 ease-in-out",children:Array.isArray(w)&&w.length>0?w.map(s=>e.jsx(be,{product:s,widthClass:"lg:w-1/3",cart:q,setCart:H},s.id)):e.jsx(he,{})}),e.jsxs("div",{className:"flex justify-between items-center mb-4 w-full mt-8",children:[e.jsx("div",{className:"customtext-primary font-semibold",children:e.jsx("div",{className:"flex justify-between items-center mb-4 w-full mt-8",children:e.jsx("div",{className:"customtext-primary font-semibold",children:e.jsxs("nav",{className:"flex items-center gap-x-2 min-w-max",children:[e.jsx("button",{className:`p-4 inline-flex items-center ${l.currentPage===1?"opacity-50 cursor-not-allowed":""}`,onClick:()=>x(l.currentPage-1),disabled:l.currentPage===1,children:e.jsx(I,{})}),T().map((s,t)=>e.jsx(V.Fragment,{children:s==="..."?e.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):e.jsx("button",{className:`w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 
                                            ${s===l.currentPage?"bg-primary text-white":"bg-transparent hover:text-white hover:bg-primary"}`,onClick:()=>x(s),children:s})},t)),e.jsx("button",{className:`p-4 inline-flex items-center ${l.currentPage===l.totalPages?"opacity-50 cursor-not-allowed":""}`,onClick:()=>x(l.currentPage+1),disabled:l.currentPage===l.totalPages,children:e.jsx(O,{})})]})})})}),e.jsx("div",{children:e.jsxs("p",{className:"font-semibold",children:[l.from," - ",l.to," de"," ",l.totalItems," Resultados"]})})]})]})]})]})})]})};export{us as default};
