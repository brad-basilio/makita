import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as l}from"./index-BH53Isel.js";import{G as z}from"./Global-ErywZRdd.js";import{C as L}from"./chevron-up-D78jyEhP.js";import{C as W}from"./chevron-down-DS-mdh9v.js";import{S as F}from"./search-TwiiKGP5.js";import{M as v,C as K}from"./map-pin-B8H2hd1R.js";import{P as R}from"./phone-BZ94M50k.js";import{M as T}from"./mail-g7FoGJuB.js";import"./index-yBjzXJbu.js";import"./createLucideIcon-Cy5Ya80P.js";const pe=({items:u=[]})=>{console.log("ZonesMakita items:",u),console.log("GMAPS_API_KEY from Global:",z.get("GMAPS_API_KEY"));const[w,Y]=l.useState(!0),[C,Z]=l.useState(!0),[d,f]=l.useState([]),[m,b]=l.useState([]),[k,q]=l.useState(""),[S,U]=l.useState(""),[i,N]=l.useState(null),[p,H]=l.useState(null),[P,A]=l.useState([]),r=l.useMemo(()=>u.filter(s=>s.type==="distributor"&&s.visible&&s.status),[u]),n=l.useMemo(()=>u.filter(s=>s.type==="service_network"&&s.visible&&s.status),[u]),O=l.useMemo(()=>r.filter(s=>s.name.toLowerCase().includes(k.toLowerCase())),[r,k]),V=l.useMemo(()=>n.filter(s=>s.name.toLowerCase().includes(S.toLowerCase())),[n,S]);l.useEffect(()=>{console.log("Initializing selections with distributors:",r.length,"services:",n.length),f(r.map(s=>s.id)),b(n.map(s=>s.id)),r.length>0?(console.log("Setting default detail to:",r[0].name),N(r[0])):n.length>0&&(console.log("Setting default detail to service:",n[0].name),N(n[0]))},[u]),l.useEffect(()=>{if(typeof google>"u"){const s=z.get("GMAPS_API_KEY");if(console.log("Loading Google Maps with API key:",s?"Key found":"No key found"),!s){console.error("GMAPS_API_KEY not found in Global configuration");return}const a=document.createElement("script");a.src=`https://maps.googleapis.com/maps/api/js?key=${s}&libraries=places`,a.async=!0,a.defer=!0,a.onload=()=>{console.log("Google Maps loaded successfully"),document.getElementById("map")&&D()},a.onerror=()=>{console.error("Failed to load Google Maps")},document.head.appendChild(a)}else console.log("Google Maps already loaded"),document.getElementById("map")&&D()},[]),l.useEffect(()=>{typeof google<"u"&&google.maps&&document.getElementById("map")&&p&&(console.log("Updating map with selections:",{distributors:d.length,services:m.length}),$(p))},[d,m,p]);const D=()=>{const s=document.getElementById("map");if(!s){console.error("Map element not found");return}console.log("Initializing Google Maps...");const a={lat:-12.0464,lng:-77.0428},o=new google.maps.Map(s,{zoom:11,center:a,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!0});console.log("Map created successfully"),H(o),setTimeout(()=>{$(o)},100)},$=l.useCallback(s=>{console.log("Adding markers to map..."),P.forEach(t=>t.setMap(null));const a=[],o=[...r.filter(t=>d.includes(t.id)),...n.filter(t=>m.includes(t.id))];if(console.log("Selected items for map:",o.length),o.forEach((t,G)=>{if(t.location){const c=t.location.split(",");if(c.length>=2){const y=parseFloat(c[0].trim()),g=parseFloat(c[1].trim());if(!isNaN(y)&&!isNaN(g)){console.log(`Adding marker for ${t.name} at ${y}, ${g}`);const x=new google.maps.Marker({position:{lat:y,lng:g},map:s,title:t.name,icon:{path:google.maps.SymbolPath.CIRCLE,scale:12,fillColor:t.type==="distributor"?"#3B82F6":"#10B981",fillOpacity:1,strokeColor:"#ffffff",strokeWeight:2}}),j=new google.maps.InfoWindow({content:`
                <div style="padding: 8px; max-width: 250px;">
                  <h3 style="margin: 0 0 8px 0; font-weight: bold;">${t.name}</h3>
                  <p style="margin: 0 0 4px 0; color: #666; font-size: 14px;">${t.address}</p>
                  <p style="margin: 0; color: #3B82F6; font-size: 12px;">${t.type==="distributor"?"Distribuidor":"Red de Servicio"}</p>
                </div>
              `});x.addListener("click",()=>{a.forEach(h=>{h.infoWindow&&h.infoWindow.close()}),j.open(s,x),N(t)}),x.infoWindow=j,a.push(x)}}}t.branches&&Array.isArray(t.branches)&&t.branches.forEach((c,y)=>{if(c.location){const g=c.location.split(",");if(g.length>=2){const x=parseFloat(g[0].trim()),j=parseFloat(g[1].trim());if(!isNaN(x)&&!isNaN(j)){console.log(`Adding branch marker for ${c.name} at ${x}, ${j}`);const h=new google.maps.Marker({position:{lat:x,lng:j},map:s,title:`${t.name} - ${c.name}`,icon:{path:google.maps.SymbolPath.CIRCLE,scale:8,fillColor:t.type==="distributor"?"#93C5FD":"#86EFAC",fillOpacity:1,strokeColor:"#ffffff",strokeWeight:1}}),I=new google.maps.InfoWindow({content:`
                    <div style="padding: 8px; max-width: 250px;">
                      <h3 style="margin: 0 0 4px 0; font-weight: bold;">${c.name}</h3>
                      <p style="margin: 0 0 4px 0; color: #666; font-size: 12px;">${t.name}</p>
                      <p style="margin: 0 0 4px 0; color: #666; font-size: 14px;">${c.address}</p>
                      <p style="margin: 0; color: #10B981; font-size: 12px;">Sucursal</p>
                    </div>
                  `});h.addListener("click",()=>{a.forEach(B=>{B.infoWindow&&B.infoWindow.close()}),I.open(s,h),N(t)}),h.infoWindow=I,a.push(h)}}}})}),A(a),a.length>0){const t=new google.maps.LatLngBounds;a.forEach(G=>t.extend(G.getPosition())),s.fitBounds(t),a.length===1&&setTimeout(()=>s.setZoom(15),100)}else s.setZoom(6)},[P,r,n,d,m,A]),_=l.useCallback(s=>{if(console.log("Item selected:",s.name,s.type),N(s),s.type==="distributor"?d.includes(s.id)||(console.log("Adding distributor to selection for map visibility"),f([...d,s.id])):s.type==="service_network"&&(m.includes(s.id)||(console.log("Adding service to selection for map visibility"),b([...m,s.id]))),p&&s.location){const a=s.location.split(",");if(a.length>=2){const o=parseFloat(a[0].trim()),t=parseFloat(a[1].trim());!isNaN(o)&&!isNaN(t)&&(p.setCenter({lat:o,lng:t}),p.setZoom(15),console.log(`Map centered on ${s.name} at ${o}, ${t}`))}}},[d,m,p]),J=l.useCallback((s,a)=>{console.log("Distributor change:",s,a),f(a?o=>[...o,s]:o=>o.filter(t=>t!==s))},[]),Q=l.useCallback((s,a)=>{console.log("Service change:",s,a),b(a?o=>[...o,s]:o=>o.filter(t=>t!==s))},[]),X=l.useCallback(s=>{console.log("Select all distributors:",s),f(s?r.map(a=>a.id):[])},[r]),ee=l.useCallback(s=>{console.log("Select all services:",s),b(s?n.map(a=>a.id):[])},[n]),M=l.useCallback(s=>s?s.split(",").map(a=>a.trim()).filter(a=>a):[],[]),E=l.useCallback(s=>s?s.split(",").map(a=>a.trim()).filter(a=>a):[],[]);return e.jsx("div",{className:"font-paragraph py-12",children:e.jsxs("div",{className:"container mx-auto px-4 md:px-6 2xl:max-w-7xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-4",children:"Encuentra tu Distribuidor y Red de Servicios Makita en Perú"}),"          ",e.jsx("p",{className:"text-gray-700",children:"Conoce los principales distribuidores y centros de servicio autorizados de Makita en Perú. Aquí encontrarás direcciones, teléfonos y contactos para adquirir herramientas originales, repuestos y acceder a mantenimiento especializado. ¡Ubica el más cercano y recibe la mejor atención!"})]}),e.jsxs("div",{className:"grid md:grid-cols-12 gap-6",children:[e.jsxs("div",{className:"md:col-span-4 lg:col-span-3",children:[e.jsxs("div",{className:"mb-6 border rounded-lg shadow-sm bg-white",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b cursor-pointer",onClick:()=>Y(!w),children:[e.jsx("h2",{className:"font-bold",children:"Lista de Distribuidores y Red de Servicios"}),w?e.jsx(L,{size:20}):e.jsx(W,{size:20})]}),w&&e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-bold mb-3",children:"Distribuidores"}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx("input",{type:"text",placeholder:"Buscar nombre",className:"w-full border rounded-lg pl-10 pr-4 py-2 text-sm",value:k,onChange:s=>q(s.target.value)}),e.jsx(F,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"rounded",checked:d.length===r.length,onChange:s=>X(s.target.checked)}),e.jsx("span",{children:"Todos"})]}),"                    ",O.map(s=>e.jsx("div",{className:"border-b border-gray-100 last:border-b-0",children:e.jsxs("div",{className:"flex items-start gap-3 p-2 hover:bg-gray-50 rounded",children:[e.jsx("input",{type:"checkbox",className:"rounded mt-1 flex-shrink-0",checked:d.includes(s.id),onChange:a=>J(s.id,a.target.checked)}),e.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>_(s),children:[e.jsx("div",{className:"font-medium text-blue-600 hover:text-blue-800 text-sm",children:s.name}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:s.address})]})]})},s.id))]})]})]}),e.jsxs("div",{className:"mb-6 border rounded-lg shadow-sm bg-white",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b cursor-pointer",onClick:()=>Z(!C),children:[e.jsx("h2",{className:"font-bold",children:"Red de Servicios"}),C?e.jsx(L,{size:20}):e.jsx(W,{size:20})]}),C&&e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx("input",{type:"text",placeholder:"Buscar nombre",className:"w-full border rounded-lg pl-10 pr-4 py-2 text-sm",value:S,onChange:s=>U(s.target.value)}),e.jsx(F,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"rounded",checked:m.length===n.length,onChange:s=>ee(s.target.checked)}),e.jsx("span",{children:"Todos"})]}),"                    ",V.map(s=>e.jsx("div",{className:"border-b border-gray-100 last:border-b-0",children:e.jsxs("div",{className:"flex items-start gap-3 p-2 hover:bg-gray-50 rounded",children:[e.jsx("input",{type:"checkbox",className:"rounded mt-1 flex-shrink-0",checked:m.includes(s.id),onChange:a=>Q(s.id,a.target.checked)}),e.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>_(s),children:[e.jsx("div",{className:"font-medium text-green-600 hover:text-green-800 text-sm",children:s.name}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:s.address})]})]})},s.id))]})]})]})]}),e.jsxs("div",{className:"md:col-span-8 lg:col-span-9",children:["            ",e.jsxs("div",{className:"w-full h-80 bg-gray-200 rounded-lg mb-8 relative overflow-hidden",children:[e.jsx("div",{id:"map",className:"w-full h-full"}),!p&&typeof google>"u"&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-600",children:"Cargando Google Maps..."}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["API Key: ",z.get("GMAPS_API_KEY")?"✓ Configurada":"✗ No encontrada"]})]})}),typeof google<"u"&&!p&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-600",children:"Inicializando mapa..."})]})})]}),i&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 border",children:[e.jsx("div",{className:"flex items-start gap-3 mb-4",children:e.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${i.type==="distributor"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:i.type==="distributor"?"Distribuidor":"Red de Servicio"})}),e.jsx("h2",{className:"font-bold text-xl mb-2",children:i.name}),i.business_name&&e.jsx("h3",{className:"text-lg text-gray-600 mb-4",children:i.business_name}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mt-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-start gap-2 mb-4",children:[e.jsx(v,{className:"text-gray-500 mt-1",size:18}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-1",children:"Dirección"}),e.jsx("p",{className:"text-gray-700",children:i.address})]})]}),M(i.phones).length>0&&e.jsxs("div",{className:"flex items-start gap-2 mb-4",children:[e.jsx(R,{className:"text-gray-500 mt-1",size:18}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-1",children:"Teléfono"}),M(i.phones).map((s,a)=>e.jsx("p",{className:"text-gray-700",children:s},a))]})]})]}),e.jsxs("div",{children:[E(i.emails).length>0&&e.jsxs("div",{className:"flex items-start gap-2 mb-4",children:[e.jsx(T,{className:"text-gray-500 mt-1",size:18}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-1",children:"Correo Electrónico"}),E(i.emails).map((s,a)=>e.jsx("p",{className:"text-gray-700",children:s},a))]})]}),i.opening_hours&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(K,{className:"text-gray-500 mt-1",size:18}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-1",children:"Horario de atención"}),e.jsx("p",{className:"text-gray-700",children:i.opening_hours})]})]})]})]}),i.branches&&i.branches.length>0&&e.jsxs("div",{className:"mt-8",children:[e.jsxs("h3",{className:"text-lg font-bold mb-4 flex items-center gap-2",children:[e.jsx(v,{size:20}),"Sucursales (",i.branches.length,")"]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:i.branches.map((s,a)=>e.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[e.jsx("h4",{className:"font-semibold mb-3 text-blue-600",children:s.name}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(v,{className:"text-gray-500 mt-1",size:16}),e.jsx("p",{className:"text-gray-700 text-sm",children:s.address})]}),s.phones&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(R,{className:"text-gray-500 mt-1",size:16}),e.jsx("div",{children:M(s.phones).map((o,t)=>e.jsx("p",{className:"text-gray-700 text-sm",children:o},t))})]}),s.emails&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(T,{className:"text-gray-500 mt-1",size:16}),e.jsx("div",{children:E(s.emails).map((o,t)=>e.jsx("p",{className:"text-gray-700 text-sm",children:o},t))})]}),s.opening_hours&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(K,{className:"text-gray-500 mt-1",size:16}),e.jsx("p",{className:"text-gray-700 text-sm",children:s.opening_hours})]})]})]},a))})]})]}),!i&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 border text-center",children:[e.jsx(v,{className:"mx-auto mb-4 text-gray-400",size:48}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Selecciona un punto en el mapa"}),e.jsx("p",{className:"text-gray-600",children:"Haz clic en cualquier marcador del mapa para ver los detalles del distribuidor o servicio técnico."})]})]})]})]})})};export{pe as default};
