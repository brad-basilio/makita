import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as x}from"./index-BH53Isel.js";import{I as X}from"./ItemsRest-DGjwRLrz.js";import{N as J}from"./NoResult-C9qZVva5.js";import{m as E}from"./main-BvVILmTO.js";import{C as Q}from"./CardProductMakita-Cc3GpF9D.js";import{X as F}from"./x-DBMwyD6F.js";import{c as $}from"./createLucideIcon-Cy5Ya80P.js";import{F as O}from"./filter-Ci9tsc_e.js";import{S as T}from"./search-TwiiKGP5.js";import{C as W}from"./chevron-down-DS-mdh9v.js";import{T as Y}from"./tag-BY9rARtP.js";import"./index-yBjzXJbu.js";import"./BasicRest-B3rfI5GY.js";import"./index-CMHsc23u.js";import"./index-rimy3MAc.js";import"./index-fNjTmf9T.js";import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=$("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=$("ListTodo",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]),M=new X,se=()=>e.jsx("div",{className:"group animate-pulse transition-transform duration-300 hover:scale-105 w-1/2 lg:w-1/4 flex-shrink-0 font-font-general customtext-primary cursor-pointer",children:e.jsx("div",{className:"px-4",children:e.jsx("div",{className:"bg-white rounded-3xl",children:e.jsx("div",{className:"relative",children:e.jsx("div",{className:"aspect-square bg-gray-300 rounded-3xl overflow-hidden flex items-center justify-center bg-secondary",children:e.jsx("svg",{className:"w-10 h-10 text-gray-200","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 18",children:e.jsx("path",{d:"M18 0H2a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2Zm-5.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm4.376 10.481A1 1 0 0 1 16 15H4a1 1 0 0 1-.895-1.447l3.5-7A1 1 0 0 1 7.468 6a.965.965 0 0 1 .9.5l2.775 4.757 1.546-1.887a1 1 0 0 1 1.618.1l2.541 4a1 1 0 0 1 .028 1.011Z"})})})})})})}),ve=({items:te,data:y,filteredData:re,cart:I,setCart:R})=>{const[f,b]=x.useState([]),[g,p]=x.useState([]),[N,j]=x.useState({}),[ae,ie]=x.useState(null),[u,v]=x.useState("grid"),[S,q]=x.useState({especificaciones:!0}),[h,C]=x.useState({specifications:{},name:E.GET.search||null}),[z,A]=x.useState(!0),L=(t,s)=>Array.isArray(t)?t.filter(r=>{var a,i,l,o;if(!r)return!1;if(s.name&&s.name.trim()!==""){const m=s.name.toLowerCase(),d=(r.name||"").toLowerCase(),n=(r.description||"").toLowerCase(),c=(r.summary||"").toLowerCase();if(!d.includes(m)&&!n.includes(m)&&!c.includes(m))return!1}if(s.specifications&&Object.keys(s.specifications).length>0){for(const[m,d]of Object.entries(s.specifications))if(d.length>0){let n=!1;switch(m){case"Color":n=d.includes(r.color);break;case"Textura":n=d.includes(r.texture);break;case"SKU":n=d.includes(r.sku);break;case"Marca":n=d.includes((a=r.brand)==null?void 0:a.name);break;case"Categoría":n=d.includes((i=r.category)==null?void 0:i.name);break;case"Subcategoría":n=d.includes((l=r.subcategory)==null?void 0:l.name);break;case"Colección":n=d.includes((o=r.collection)==null?void 0:o.name);break;default:n=d.some(c=>r.name.toLowerCase().includes(c.toLowerCase()));break}if(!n)return!1}}return!0}):(console.log("filterProducts: products no es un array:",t),[]),B=t=>{const s={};if(!Array.isArray(t)||t.length===0)return console.log("No hay productos para procesar o products no es un array:",t),{};t.forEach(a=>{var l,o,m,d;if(!a)return;const i={Color:a.color,Textura:a.texture,SKU:a.sku,Marca:(l=a.brand)==null?void 0:l.name,Categoría:(o=a.category)==null?void 0:o.name,Subcategoría:(m=a.subcategory)==null?void 0:m.name,Colección:(d=a.collection)==null?void 0:d.name};if(Object.entries(i).forEach(([n,c])=>{c&&c.toString().trim()!==""&&c.toString().trim()!=="null"&&(s[n]||(s[n]=new Set),s[n].add(c.toString().trim()))}),a.specifications&&typeof a.specifications=="object"&&Object.entries(a.specifications).forEach(([n,c])=>{c&&c.toString().trim()!==""&&c.toString().trim()!=="null"&&(s[n]||(s[n]=new Set),s[n].add(c.toString().trim()))}),a.name){const n=G(a.name);Object.entries(n).forEach(([c,V])=>{s[c]||(s[c]=new Set),s[c].add(V)})}});const r={};return Object.entries(s).forEach(([a,i])=>{i.size>1&&(r[a]=Array.from(i).sort())}),r},G=t=>{const s={};return[{regex:/(\d+)w/gi,key:"Potencia"},{regex:/(\d+)v/gi,key:"Voltaje"},{regex:/(\d+)-(\d+)\s*rpm/gi,key:"RPM"},{regex:/(\d+\.?\d*)\s*kg/gi,key:"Peso"},{regex:/(\d+\.?\d*)\s*mm/gi,key:"Medida"},{regex:/(\d+\.?\d*)\s*nm/gi,key:"Torque"},{regex:/(\d+\.?\d*)""/gi,key:"Pulgadas"}].forEach(a=>{const i=[...t.matchAll(a.regex)];if(i.length>0){const l=i.map(o=>o[1]||o[0]).filter(Boolean);l.length>0&&(s[a.key]=l[0])}}),s},D=async()=>{A(!0);try{const t={take:1e4,skip:0,requireTotalCount:!1};console.log("Obteniendo todos los productos..."),console.log("Parámetros enviados:",t),console.log("ItemsRest instance:",M);const s=await M.paginate(t);if(console.log("Respuesta completa de la API:",s),!s||!s.data){console.error("La respuesta de la API no tiene la estructura esperada:",s),b([]),p([]),j({});return}let r=[];s&&s.data&&(Array.isArray(s.data)?r=s.data:s.data.data&&Array.isArray(s.data.data)?r=s.data.data:s.data.items&&Array.isArray(s.data.items)&&(r=s.data.items)),console.log("Productos extraídos:",r),b(r);const a=B(r);console.log("Especificaciones procesadas:",a),j(a);const i=L(r,h);p(i)}catch(t){console.error("Error fetching products:",t),b([]),p([]),j({})}finally{A(!1)}};x.useEffect(()=>{D()},[]),x.useEffect(()=>{if(Array.isArray(f)&&f.length>0){const t=L(f,h);p(t)}else p([])},[h,f]);const w=(t,s,r=null)=>{C(a=>{if(t==="specifications"){const i={...a.specifications};i[r]||(i[r]=[]);const l=i[r],o=l.includes(s)?l.filter(m=>m!==s):[...l,s];return o.length===0?delete i[r]:i[r]=o,{...a,specifications:i}}return{...a,[t]:s}})},Z=t=>{q(s=>({...s,[t]:!s[t]}))},H=()=>{C({specifications:{},name:E.GET.search||null})},[P,K]=x.useState({}),[U,k]=x.useState(!1);return e.jsx("section",{className:"py-12 bg-sections-color customtext-neutral-dark",children:e.jsxs("div",{className:"mx-auto px-primary 2xl:px-0 2xl:max-w-7xl",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between items-center mb-8 pb-4 border-b-2",children:[e.jsx("h2",{className:"text-[32px] md:text-4xl font-bold md:w-6/12",children:y==null?void 0:y.title}),e.jsxs("div",{className:"flex flex-col w-full items-center justify-end gap-4 md:flex-row md:w-5/12",children:[e.jsxs("span",{className:"block md:w-6/12 order-1 md:order-none",children:["Productos encontrados:"," ",e.jsx("strong",{children:Array.isArray(g)?g.length:0}),Array.isArray(f)&&f.length>0&&e.jsxs("span",{className:"text-gray-500 text-sm",children:[" de ",f.length]})]}),Object.keys(h.specifications).length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 text-xs",children:Object.entries(h.specifications).map(([t,s])=>s.map(r=>e.jsxs("span",{className:"bg-primary/10 text-primary px-2 py-1 rounded-full flex items-center gap-1",children:[t,": ",r,e.jsx("button",{onClick:()=>w("specifications",r,t),className:"hover:bg-primary/20 rounded-full p-0.5",children:e.jsx(F,{className:"h-3 w-3"})})]},`${t}-${r}`)))}),e.jsxs("div",{className:"flex items-center gap-2 mr-2",children:[e.jsx("button",{onClick:()=>v("grid"),className:`p-2 rounded-md ${u==="grid"?"bg-primary text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,title:"Vista grilla",children:e.jsx(_,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>v("list"),className:`p-2 rounded-md ${u==="list"?"bg-primary text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,title:"Vista lista",children:e.jsx(ee,{className:"h-5 w-5"})})]})]})]}),e.jsxs("div",{className:"relative flex flex-col lg:flex-row gap-4",children:[e.jsxs("button",{className:"w-full flex lg:hidden gap-2 items-center",onClick:()=>k(!0),children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Filtros"}),e.jsx(O,{className:"h-5 w-5"})]}),e.jsxs("div",{className:`${U?"fixed inset-0  bg-white flex flex-col h-screen z-[999]":"hidden"} lg:block lg:w-3/12 lg:bg-white lg:p-4 lg:rounded-lg lg:h-max`,children:[e.jsxs("div",{className:"fixed top-0 left-0 right-0 bg-white p-4 border-b z-10 h-16 flex items-center justify-between lg:relative lg:p-0 lg:border-none lg:h-auto",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Filtros"}),e.jsxs("div",{className:"flex items-center gap-2",children:[Object.keys(h.specifications).length>0&&e.jsx("button",{onClick:H,className:"text-sm text-primary hover:text-primary-dark underline",children:"Limpiar"}),e.jsx("button",{className:"lg:hidden",onClick:()=>k(!1),children:e.jsx(F,{className:"h-5 w-5"})}),e.jsx(O,{className:"hidden lg:block h-5 w-5"})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-4 mt-16 pb-20 lg:mt-0 lg:pb-0 lg:px-0",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsx(T,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar productos...",className:"w-full pl-10 pr-4 py-3 border rounded-xl focus:ring-1 focus:ring-primary/50 focus:outline-0",value:h.name||"",onChange:t=>w("name",t.target.value)})]})}),Object.keys(N||{}).length>0?e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>Z("especificaciones"),className:"flex items-center justify-between w-full mb-4 p-2 lg:p-0",children:[e.jsx("span",{className:"font-medium",children:"Características"}),e.jsx(W,{className:`h-5 w-5 transform transition-transform ${S.especificaciones?"":"-rotate-180"}`})]}),S.especificaciones&&e.jsx("div",{className:"space-y-4",children:Object.entries(N).map(([t,s])=>{var i;const r=P[t]||"",a=s.filter(l=>l.toLowerCase().includes(r.toLowerCase()));return e.jsxs("div",{className:"border-b border-gray-100 pb-4 last:border-b-0",children:[e.jsxs("h4",{className:"font-medium text-sm text-gray-700 mb-3 flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4"}),t,e.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full",children:s.length}),((i=h.specifications[t])==null?void 0:i.length)>0&&e.jsxs("span",{className:"text-xs text-primary bg-primary/10 px-2 py-1 rounded-full",children:[h.specifications[t].length," seleccionados"]})]}),s.length>5&&e.jsxs("div",{className:"relative mb-3",children:[e.jsx(T,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-3 w-3 text-gray-400"}),e.jsx("input",{type:"text",placeholder:`Buscar en ${t.toLowerCase()}`,className:"w-full pl-8 pr-4 py-2 text-sm border rounded-lg focus:ring-1 focus:ring-primary/50 focus:outline-0",value:P[t]||"",onChange:l=>K(o=>({...o,[t]:l.target.value}))})]}),e.jsxs("div",{className:"space-y-2 max-h-[120px] overflow-y-auto",children:[a.map(l=>{var m;const o=((m=h.specifications[t])==null?void 0:m.includes(l))||!1;return e.jsxs("label",{className:`flex items-center gap-2 py-1.5 px-2 rounded-md hover:bg-gray-50 cursor-pointer transition-colors ${o?"bg-primary/5 border border-primary/20":""}`,children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300 accent-primary",onChange:()=>w("specifications",l,t),checked:o}),e.jsx("span",{className:`text-sm ${o?"text-primary font-medium":"text-gray-700"}`,children:l})]},`${t}-${l}`)}),a.length===0&&r&&e.jsx("p",{className:"text-sm text-gray-500 italic py-2 text-center",children:"No se encontraron coincidencias"})]})]},t)})})]}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{children:"No hay características disponibles para filtrar"}),e.jsx("p",{className:"text-sm",children:"Los filtros se generarán cuando se carguen los productos"})]})]}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t p-4 h-20 flex items-center lg:hidden",children:e.jsx("button",{className:"w-full bg-primary text-white py-3 rounded-xl font-bold hover:bg-primary-dark transition-colors",onClick:()=>k(!1),children:"Ver resultados"})})]}),e.jsx("div",{className:"w-full lg:w-9/12 py-4",children:z?e.jsx("div",{className:"flex items-center flex-wrap gap-y-8 transition-all duration-300 ease-in-out",children:[1,2,3,4,5,6,7,8,9,10,11,12].map(t=>e.jsx(se,{},t))}):e.jsx("div",{className:`flex ${u==="grid"?"items-center flex-wrap":"flex-col gap-6"} transition-all duration-300 ease-in-out`,children:Array.isArray(g)&&g.length>0?g.map(t=>e.jsx("div",{className:u==="grid"?"w-1/2 lg:w-1/3 xl:w-1/3 lg:h-[460px] lg:max-h-[460px] xl:h-[400px] xl:max-h-[400px] 2xl:h-[430px] 2xl:max-h-[430px] flex items-center justify-center":"w-full mb-2 flex items-center justify-center shadow-sm hover:shadow-lg transition-shadow duration-200",children:e.jsx(Q,{data:y,product:t,viewType:u,widthClass:"w-full sm:w-full lg:w-full",cart:I,setCart:R})},t.id)):e.jsxs("div",{className:"w-full text-center py-12",children:[e.jsx(J,{}),f.length>0&&e.jsx("p",{className:"text-gray-500 mt-4",children:"Intenta ajustar los filtros para ver más productos"})]})})})]})]})})};export{ve as default};
