import{j as s}from"./AboutSimple-Cf8x2fCZ.js";import{r as d}from"./index-BH53Isel.js";import{I as Y}from"./ItemsRest-DGjwRLrz.js";import{N as _}from"./NoResult-C9qZVva5.js";import{m as $}from"./main-BvVILmTO.js";import{C as ee}from"./CardProductMakita-D9GuUtEe.js";import{F as se}from"./filter-Ci9tsc_e.js";import{X as te}from"./x-DBMwyD6F.js";import{C as ie}from"./chevron-down-DS-mdh9v.js";import{S as ae}from"./search-TwiiKGP5.js";import"./index-yBjzXJbu.js";import"./BasicRest-B3rfI5GY.js";import"./index-CMHsc23u.js";import"./index-rimy3MAc.js";import"./index-fNjTmf9T.js";import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";import"./createLucideIcon-Cy5Ya80P.js";const L=new Y,re=()=>s.jsx("div",{className:"group animate-pulse transition-transform duration-300 hover:scale-105 w-1/2 lg:w-1/4 flex-shrink-0 font-font-general customtext-primary cursor-pointer",children:s.jsx("div",{className:"px-4",children:s.jsx("div",{className:"bg-white rounded-3xl",children:s.jsx("div",{className:"relative",children:s.jsx("div",{className:"aspect-square bg-gray-300 rounded-3xl overflow-hidden flex items-center justify-center bg-secondary",children:s.jsx("svg",{className:"w-10 h-10 text-gray-200","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 18",children:s.jsx("path",{d:"M18 0H2a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2Zm-5.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm4.376 10.481A1 1 0 0 1 16 15H4a1 1 0 0 1-.895-1.447l3.5-7A1 1 0 0 1 7.468 6a.965.965 0 0 1 .9.5l2.775 4.757 1.546-1.887a1 1 0 0 1 1.618.1l2.541 4a1 1 0 0 1 .028 1.011Z"})})})})})})}),Pe=({items:oe,data:O,filteredData:le,cart:R,setCart:Z})=>{const[p,j]=d.useState([]),[C,u]=d.useState([]),[S,k]=d.useState({}),[ne,ce]=d.useState(null),[y,N]=d.useState("grid"),[P,T]=d.useState({especificaciones:!0}),[w,A]=d.useState({specifications:{},name:$.GET.search||null}),[B,V]=d.useState(!0),F=()=>{const e=new URLSearchParams(window.location.search).get("category");return e?e.split("-").map(i=>i.charAt(0).toLowerCase()+i.slice(1)).join(" "):"Catalogo"},[I,D]=d.useState(F());d.useEffect(()=>{D(F())},[window.location.search]);const E=(a,e)=>Array.isArray(a)?a.filter(i=>{var t,r,o,n,m,f;if(!i)return!1;if(e.name&&e.name.trim()!==""){const x=e.name.toLowerCase(),h=(i.name||"").toLowerCase(),l=(i.description||"").toLowerCase(),c=(i.summary||"").toLowerCase();if(!h.includes(x)&&!l.includes(x)&&!c.includes(x))return!1}if(e.specifications&&Object.keys(e.specifications).length>0){for(const[x,h]of Object.entries(e.specifications))if(h.length>0){let l=!1;if(i.specifications&&Array.isArray(i.specifications)&&i.specifications.forEach(c=>{c.type==="technical"&&c.title===x&&h.includes(c.description)&&(l=!0)}),!l){const c={Color:i.color,Textura:i.texture,SKU:i.sku,Marca:(t=i.brand)==null?void 0:t.name,Categoría:(r=i.category)==null?void 0:r.name,Subcategoría:(o=i.subcategory)==null?void 0:o.name,Colección:(n=i.collection)==null?void 0:n.name,Plataforma:(m=i.platform)==null?void 0:m.name,Familia:(f=i.family)==null?void 0:f.name};c[x]?l=h.includes(c[x]):l=h.some(g=>i.name.toLowerCase().includes(g.toLowerCase()))}if(!l)return!1}}return!0}):(console.log("filterProducts: products no es un array:",a),[]),U=a=>{console.log("Iniciando procesamiento de especificaciones para",a.length,"productos");const e={};if(!Array.isArray(a)||a.length===0)return console.log("No hay productos para procesar o products no es un array:",a),{};a.forEach(t=>{var o,n,m,f,x,h;if(!t)return;console.log(`
=== PROCESANDO PRODUCTO: ${t.name} ===`),console.log("Especificaciones del producto:",t.specifications),t.specifications&&Array.isArray(t.specifications)?(console.log(`Procesando ${t.specifications.length} especificaciones para producto ${t.name}`),t.specifications.forEach((l,c)=>{if(console.log(`Especificación ${c+1}:`,{type:l.type,title:l.title,description:l.description}),l.type==="technical"&&l.title&&l.description){const g=l.title.trim(),b=l.description.trim();console.log(`✅ Especificación técnica válida: "${g}" = "${b}"`),g!==""&&b!==""&&b!=="null"&&(e[g]||(e[g]=new Set,console.log(`📝 Creando nueva categoría de filtro: "${g}"`)),e[g].add(b),console.log(`➕ Agregando valor "${b}" a filtro "${g}"`))}else console.log(`❌ Especificación omitida - Tipo: ${l.type}, Título: ${l.title}, Descripción: ${l.description}`)})):console.log(`⚠️ Producto ${t.name} no tiene especificaciones o no es un array:`,t.specifications);const r={Color:t.color,Textura:t.texture,Marca:(o=t.brand)==null?void 0:o.name,Categoría:(n=t.category)==null?void 0:n.name,Subcategoría:(m=t.subcategory)==null?void 0:m.name,Colección:(f=t.collection)==null?void 0:f.name,Plataforma:(x=t.platform)==null?void 0:x.name,Familia:(h=t.family)==null?void 0:h.name};if(Object.entries(r).forEach(([l,c])=>{c&&c.toString().trim()!==""&&c.toString().trim()!=="null"&&(e[l]||(e[l]=new Set),e[l].add(c.toString().trim()))}),t.specifications&&typeof t.specifications=="object"&&!Array.isArray(t.specifications)&&(console.log("Procesando especificaciones como objeto:",t.specifications),Object.entries(t.specifications).forEach(([l,c])=>{c&&c.toString().trim()!==""&&c.toString().trim()!=="null"&&(e[l]||(e[l]=new Set),e[l].add(c.toString().trim()))})),t.name){const l=z(t.name);Object.entries(l).forEach(([c,g])=>{e[c]||(e[c]=new Set),e[c].add(g)})}});const i={};return Object.entries(e).forEach(([t,r])=>{r.size>0&&(i[t]=Array.from(r).sort((o,n)=>{const m=parseFloat(o),f=parseFloat(n);return!isNaN(m)&&!isNaN(f)?m-f:o.localeCompare(n)}))}),console.log(`
🎯 RESUMEN DE ESPECIFICACIONES PROCESADAS:`),Object.entries(i).forEach(([t,r])=>{console.log(`📋 ${t}: ${r.length} valores únicos`,r)}),i},z=a=>{const e={};return[{regex:/(\d+(?:\.\d+)?)\s*w(?:att)?s?/gi,key:"Potencia (W)"},{regex:/(\d+(?:\.\d+)?)\s*kw/gi,key:"Potencia (kW)"},{regex:/(\d+(?:\.\d+)?)\s*v(?:olt)?s?/gi,key:"Tensión nominal (V)"},{regex:/(\d+(?:[,.]\d+)?)\s*-\s*(\d+(?:[,.]\d+)?)\s*rpm/gi,key:"Velocidad (RPM)"},{regex:/(\d+(?:[,.]\d+)?)\s*rpm/gi,key:"Velocidad (RPM)"},{regex:/(\d+(?:[,.]\d+)?)\s*min⁻¹/gi,key:"Velocidad (min⁻¹)"},{regex:/(\d+(?:\.\d+)?)\s*kg/gi,key:"Peso (kg)"},{regex:/(\d+(?:\.\d+)?)\s*g(?!r)/gi,key:"Peso (g)"},{regex:/(\d+(?:\.\d+)?)\s*x\s*(\d+(?:\.\d+)?)\s*x\s*(\d+(?:\.\d+)?)\s*mm/gi,key:"Dimensiones (mm)"},{regex:/(\d+(?:\.\d+)?)\s*mm/gi,key:"Medida (mm)"},{regex:/(\d+(?:\.\d+)?)\s*cm/gi,key:"Medida (cm)"},{regex:/(\d+(?:\.\d+)?)\s*nm/gi,key:"Torque (Nm)"},{regex:/(\d+(?:\.\d+)?)\s*"/gi,key:"Medida (pulgadas)"},{regex:/(\d+(?:\.\d+)?)\s*''/gi,key:"Medida (pulgadas)"},{regex:/(\d+(?:\.\d+)?)\s*l(?:itros?)?/gi,key:"Capacidad (L)"},{regex:/(\d+(?:\.\d+)?)\s*ml/gi,key:"Capacidad (ml)"},{regex:/(\d+(?:\.\d+)?)\s*ah/gi,key:"Capacidad batería (Ah)"},{regex:/(\d+(?:\.\d+)?)\s*mah/gi,key:"Capacidad batería (mAh)"},{regex:/(\d+(?:\.\d+)?)\s*bar/gi,key:"Presión (bar)"},{regex:/(\d+(?:\.\d+)?)\s*psi/gi,key:"Presión (PSI)"},{regex:/(\d+(?:\.\d+)?)\s*mbar/gi,key:"Presión (mbar)"},{regex:/(\d+(?:\.\d+)?)\s*m³\/min/gi,key:"Volumen de aire (m³/min)"},{regex:/(\d+(?:\.\d+)?)\s*cfm/gi,key:"Volumen de aire (CFM)"},{regex:/(\d+(?:\.\d+)?)\s*db\(a\)/gi,key:"Nivel sonoro (dB(A))"},{regex:/(\d+(?:\.\d+)?)\s*db/gi,key:"Nivel sonoro (dB)"},{regex:/(\d+(?:\.\d+)?)\s*hz/gi,key:"Frecuencia (Hz)"},{regex:/(\d+(?:\.\d+)?)\s*°c/gi,key:"Temperatura (°C)"},{regex:/(\d+(?:\.\d+)?)\s*°f/gi,key:"Temperatura (°F)"}].forEach(t=>{const r=[...a.matchAll(t.regex)];r.length>0&&r.forEach(o=>{let n;t.key==="Dimensiones (mm)"&&o[3]?n=`${o[1]} x ${o[2]} x ${o[3]} mm`:t.key==="Velocidad (RPM)"&&o[2]?n=`${o[1]} - ${o[2]} RPM`:n=o[1]||o[0],n&&n.toString().trim()!==""&&(e[t.key]||(e[t.key]=n.toString().trim()))})}),e},q=async()=>{V(!0);try{const a={take:1e4,skip:0,requireTotalCount:!1,with:"specifications,category,brand,collection,platform,family"};console.log("Obteniendo todos los productos..."),console.log("Parámetros enviados:",a),console.log("ItemsRest instance:",L);const e=await L.paginate(a);if(console.log("Respuesta completa de la API:",e),!e||!e.data){console.error("La respuesta de la API no tiene la estructura esperada:",e),j([]),u([]),k({});return}let i=[];e&&e.data&&(Array.isArray(e.data)?i=e.data:e.data.data&&Array.isArray(e.data.data)?i=e.data.data:e.data.items&&Array.isArray(e.data.items)&&(i=e.data.items)),console.log("Productos extraídos:",i),j(i);const t=U(i);console.log("Especificaciones procesadas:",t),k(t);const r=M(i),o=E(r,w);u(o)}catch(a){console.error("Error fetching products:",a),j([]),u([]),k({})}finally{V(!1)}},G=()=>{const a=new URLSearchParams(window.location.search),e={},i=a.get("category"),t=a.get("platform"),r=a.get("family"),o=a.get("brand"),n=a.get("collection");return i&&(e.category=i),t&&(e.platform=t),r&&(e.family=r),o&&(e.brand=o),n&&(e.collection=n),e},M=a=>{const e=G();return Object.keys(e).length===0?a:(console.log("Aplicando filtros desde URL:",e),a.filter(i=>{var r,o,n,m,f;let t=!0;return e.category&&((r=i.category)==null?void 0:r.slug)!==e.category&&(t=!1),e.platform&&((o=i.platform)==null?void 0:o.slug)!==e.platform&&(t=!1),e.family&&((n=i.family)==null?void 0:n.slug)!==e.family&&(t=!1),e.brand&&((m=i.brand)==null?void 0:m.slug)!==e.brand&&(t=!1),e.collection&&((f=i.collection)==null?void 0:f.slug)!==e.collection&&(t=!1),t}))};d.useEffect(()=>{q()},[]),d.useEffect(()=>{if(Array.isArray(p)&&p.length>0){const a=M(p),e=E(a,w);u(e)}else u([])},[w,p]);const W=(a,e,i=null)=>{A(t=>{{const r={...t.specifications};r[i]||(r[i]=[]);const o=r[i],n=o.includes(e)?o.filter(m=>m!==e):[...o,e];return n.length===0?delete r[i]:r[i]=n,{...t,specifications:r}}})},K=a=>{T(e=>({...e,[a]:!e[a]}))},X=()=>{A({specifications:{},name:$.GET.search||null})},[H,J]=d.useState({}),[Q,v]=d.useState(!1);return s.jsx("section",{className:"py-12 bg-sections-color customtext-neutral-dark",children:s.jsx("div",{className:"mx-auto px-primary 2xl:px-0 2xl:max-w-7xl",children:s.jsxs("div",{className:"relative flex flex-col lg:flex-row gap-10",children:[s.jsxs("button",{className:"w-full flex lg:hidden gap-2 items-center",onClick:()=>v(!0),children:[s.jsx("h2",{className:"text-2xl font-bold",children:"Filtros"}),s.jsx(se,{className:"h-5 w-5"})]}),s.jsxs("div",{className:`${Q?"fixed inset-0  bg-white flex flex-col h-screen z-[999]":"hidden"} lg:block lg:w-3/12 lg:bg-white lg:p-4 lg:rounded-lg lg:h-max`,children:[s.jsxs("div",{className:"fixed top-0 left-0 right-0 bg-white p-4 border-b z-10 h-16 flex items-center justify-between lg:relative lg:p-0 lg:border-none lg:h-auto",children:[s.jsx("h2",{className:"text-3xl tracking-wider font-bold",children:"Filtros"}),s.jsxs("div",{className:"flex items-center gap-2",children:[Object.keys(w.specifications).length>0&&s.jsx("button",{onClick:X,className:"text-sm text-primary hover:text-primary-dark underline",children:"Limpiar"}),s.jsx("button",{className:"lg:hidden",onClick:()=>v(!1),children:s.jsx(te,{className:"h-5 w-5"})})]})]}),s.jsx("div",{className:"flex-1  overflow-y-auto px-4 mt-16 pb-20 lg:mt-6 lg:pb-0 lg:px-0",children:Object.keys(S||{}).length>0?s.jsx("div",{className:"mb-6",children:Object.entries(S).map(([a,e])=>{const i=H[a]||"",t=e.filter(r=>r.toLowerCase().includes(i.toLowerCase()));return s.jsxs("div",{className:"mb-0",children:[s.jsxs("button",{onClick:()=>K(a),className:"flex  bg-[#F6F6F6] items-center justify-between w-full  p-2 lg:p-2",children:[s.jsx("span",{className:"font-medium text-lg",children:a}),s.jsx(ie,{className:`h-5 w-5 transform transition-transform ${P[a]?"":"-rotate-180"}`})]}),P[a]&&s.jsxs("div",{className:"bg-white rounded-md p-3 ",children:[e.length>5&&s.jsxs("div",{className:"relative mb-3 text-[#262626]",children:[s.jsx(ae,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-3 w-3 text-[#262626]"}),s.jsx("input",{type:"text",placeholder:`Buscar en ${a.toLowerCase()}`,className:"w-full pl-8 pr-4 py-2 text-sm border rounded-lg focus:ring-1 focus:ring-primary/50 focus:outline-0",value:H[a]||"",onChange:r=>J(o=>({...o,[a]:r.target.value}))})]}),s.jsxs("div",{className:"space-y-2 max-h-[120px] overflow-y-auto",children:[t.map(r=>{var n;const o=((n=w.specifications[a])==null?void 0:n.includes(r))||!1;return s.jsxs("label",{className:"flex items-center gap-2 py-1.5 px-2  hover:bg-gray-50 cursor-pointer transition-colors ",onClick:()=>W("specifications",r,a),children:[s.jsx("div",{className:"relative h-4 w-4",children:o?s.jsx("svg",{width:"16",height:"15",viewBox:"0 0 16 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M6.83333 11L12.7083 5.125L11.5417 3.95833L6.83333 8.66667L4.45833 6.29167L3.29167 7.45833L6.83333 11ZM2.16667 15C1.70833 15 1.31597 14.8368 0.989583 14.5104C0.663194 14.184 0.5 13.7917 0.5 13.3333V1.66667C0.5 1.20833 0.663194 0.815972 0.989583 0.489583C1.31597 0.163194 1.70833 0 2.16667 0H13.8333C14.2917 0 14.684 0.163194 15.0104 0.489583C15.3368 0.815972 15.5 1.20833 15.5 1.66667V13.3333C15.5 13.7917 15.3368 14.184 15.0104 14.5104C14.684 14.8368 14.2917 15 13.8333 15H2.16667ZM2.16667 13.3333H13.8333V1.66667H2.16667V13.3333Z",fill:"#219FB9"})}):s.jsx("div",{className:"h-4 w-4 border-2 border-neutral-dark bg-white rounded"})}),s.jsx("span",{className:`text-sm font-medium ${o?"text-[#262626] font-bold":"text-[#262626]"}`,children:r})]},`${a}-${r}`)}),t.length===0&&i&&s.jsx("p",{className:"text-sm text-gray-500 italic py-2 text-center",children:"No se encontraron coincidencias"})]})]})]},a)})}):s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx("p",{children:"No hay características disponibles para filtrar"}),s.jsx("p",{className:"text-sm",children:"Los filtros se generarán cuando se carguen los productos"})]})}),s.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t p-4 h-20 flex items-center lg:hidden",children:s.jsx("button",{className:"w-full bg-primary text-white py-3 rounded-xl font-bold hover:bg-primary-dark transition-colors",onClick:()=>v(!1),children:"Ver resultados"})})]}),s.jsxs("div",{className:"w-full lg:w-9/12 py-4",children:[s.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between items-center mb-8 pb-4 border-b-2",children:[s.jsxs("h2",{className:"text-[32px] md:text-4xl font-bold md:w-6/12",children:["Categoria ",I]}),s.jsx("div",{className:"flex flex-col w-full items-center justify-end gap-4 md:flex-row md:w-5/12",children:s.jsxs("div",{className:"flex items-center gap-2 mr-2",children:[s.jsx("button",{onClick:()=>N("grid"),className:`p-2 rounded-md ${y==="grid"?"bg-white fill-[#219FB9]":"bg-white fill-[#262626] "}`,title:"Vista grilla",children:s.jsx("svg",{width:"18",height:"19",viewBox:"0 0 18 19",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M0 8.5V0.5H8V8.5H0ZM0 18.5V10.5H8V18.5H0ZM10 8.5V0.5H18V8.5H10ZM10 18.5V10.5H18V18.5H10ZM2 6.5H6V2.5H2V6.5ZM12 6.5H16V2.5H12V6.5ZM12 16.5H16V12.5H12V16.5ZM2 16.5H6V12.5H2V16.5Z"})})}),s.jsx("button",{onClick:()=>N("list"),className:`p-2 rounded-md ${y==="list"?"bg-white fill-[#219FB9]":"bg-white fill-[#262626] "}`,title:"Vista lista",children:s.jsx("svg",{width:"18",height:"19",viewBox:"0 0 18 19",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M2 14.5C1.45 14.5 0.979167 14.3042 0.5875 13.9125C0.195833 13.5208 0 13.05 0 12.5V6.5C0 5.95 0.195833 5.47917 0.5875 5.0875C0.979167 4.69583 1.45 4.5 2 4.5H16C16.55 4.5 17.0208 4.69583 17.4125 5.0875C17.8042 5.47917 18 5.95 18 6.5V12.5C18 13.05 17.8042 13.5208 17.4125 13.9125C17.0208 14.3042 16.55 14.5 16 14.5H2ZM2 12.5H16V6.5H2V12.5ZM0 2.5V0.5H18V2.5H0ZM0 18.5V16.5H18V18.5H0Z"})})})]})})]}),B?s.jsx("div",{className:"flex items-center flex-wrap gap-y-8 transition-all duration-300 ease-in-out",children:[1,2,3,4,5,6,7,8,9,10,11,12].map(a=>s.jsx(re,{},a))}):s.jsx("div",{className:`flex ${y==="grid"?"items-center flex-wrap":"flex-col gap-6"} transition-all duration-300 ease-in-out`,children:Array.isArray(C)&&C.length>0?C.map(a=>s.jsx("div",{className:y==="grid"?"w-1/2 lg:w-1/3 xl:w-1/3 lg:h-[460px] lg:max-h-[460px] xl:h-[400px] xl:max-h-[400px] 2xl:h-[430px] 2xl:max-h-[430px] flex items-center justify-center":"w-full mb-2 flex items-center justify-center shadow-sm hover:shadow-lg transition-shadow duration-200",children:s.jsx(ee,{data:O,product:a,viewType:y,widthClass:"w-full sm:w-full lg:w-full",cart:R,setCart:Z})},a.id)):s.jsxs("div",{className:"w-full text-center py-12",children:[s.jsx(_,{}),p.length>0&&s.jsx("p",{className:"text-gray-500 mt-4",children:"Intenta ajustar los filtros para ver más productos"})]})})]})]})})})};export{Pe as default};
